<schema name="Business" database="MyCo" xmlns="http://sqlfairy.sourceforge.net/sqlfairy.xml">
<comments>The MIT License (MIT) Copyright (c) 2014 Stephen A Jazdzewski</comments>

<tables>
<table name="Culture" order="1">
<fields>
 <field name="code" data_type="integer" size="10" is_nullable="0" is_auto_increment="0" is_primary_key="1" order="2">
  <comments>Like 1033 http://msdn.microsoft.com/en-us/library/ee825488(v=cs.20).aspx</comments></field>
 <field name="name" data_type="varchar" size="9" is_nullable="0" is_auto_increment="0" is_primary_key="0" order="3">
  <comments>Like en-US</comments></field>
</fields>
<indices>
 <index name="culture_code" type="UNIQUE" fields="code" />
</indices>
</table>

<table name="Word" order="2">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" />
 <field name="culture" data_type="integer" size="10" is_nullable="1" is_foreign_key="1" default_value="1033" order="2" />
 <field name="value" data_type="varchar" size="20" is_nullable="0" order="3" />
</fields>
<indices>
 <index name="word_id_culture" type="NORMAL" fields="id,culture" />
</indices>
<constraints>
 <constraint name="" type="NOT NULL" fields="value" reference_table="" reference_fields="" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="culture" reference_table="Culture" reference_fields="code" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
</constraints>
<comments></comments>
</table>

<table name="Sentence" order="3">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" />
 <field name="culture" data_type="integer" size="10" is_nullable="1" is_foreign_key="1" default_value="1033" order="2" />
 <field name="value" data_type="varchar" size="256" is_nullable="0" order="3" />
 <field name="length" data_type="smallint" size="3" is_nullable="1" order="4" >
  <comments>Used for dynamic drop list item sorting</comments>
 </field>
</fields>
<indices>
 <index name="sentence_id_culture" type="NORMAL" fields="id,culture" />
 <index name="sentence_culture_value" type="UNIQUE" fields="culture,value" />
</indices>
<constraints>
 <constraint name="" type="NOT NULL" fields="value" reference_table="" reference_fields="" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="culture" reference_table="Culture" reference_fields="code" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
</constraints>
<comments></comments>
</table>

<table name="untestedParagraph" order="4">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="culture" data_type="integer" size="10" is_nullable="1" is_foreign_key="1" default_value="1033" order="2" />
 <field name="value" data_type="text" size="0" is_nullable="0" order="3" />
</fields>
<indices>
 <index name="paragraph_id_culture" type="NORMAL" fields="id,culture" />
 <index name="paragraph_culture_value" type="UNIQUE" fields="culture,value" />
</indices>
<constraints>
 <constraint name="" type="NOT NULL" fields="value" reference_table="" reference_fields="" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="culture" reference_table="Culture" reference_fields="code" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
</constraints>
<comments></comments>
</table>

<table name="Given" order="18">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="value" data_type="varchar" size="20" is_nullable="0" order="3" />
</fields>
<indices>
 <index name="given_value" type="UNIQUE" fields="value" />
</indices>
<constraints>
 <constraint name="" type="NOT NULL" fields="value" reference_table="" reference_fields="" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
</constraints>
<comments></comments>
</table>

<table name="Family" order="19">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="value" data_type="varchar" size="20" is_nullable="0" order="3" />
</fields>
<indices>
 <index name="family_value" type="UNIQUE" fields="value" />
</indices>
<constraints>
 <constraint name="" type="NOT NULL" fields="value" reference_table="" reference_fields="" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
</constraints>
<comments></comments>
</table>

<table name="Name" order="20">
<fields>
 <field name="id" data_type="integer" size="10" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="given" data_type="integer" size="10" is_nullable="1" is_foreign_key="1" order="3" />
 <field name="middle" data_type="integer" size="10" is_nullable="1" is_foreign_key="1" order="4" />
 <field name="family" data_type="integer" size="10" is_nullable="1" is_foreign_key="1" order="5" />
</fields>
<indices>
 <index name="name_given_middle_family" type="UNIQUE" fields="given,middle,family" />
</indices>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="given" reference_table="Given" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="middle" reference_table="Given" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="family" reference_table="Family" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
</constraints>
</table>

<table name="Company" order="21">
<fields>
 <field name="id" data_type="integer" size="10" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="name" data_type="varchar" size="50" is_nullable="1" order="2" />
</fields>
<indices>
 <index name="company_name" type="UNIQUE" fields="name" />
</indices>
<constraints>
</constraints>
</table>

<table name="Individual" order="22">
<fields>
 <field name="id" data_type="integer" size="10" is_nullable="0" is_auto_increment="1" is_primary_key="0" order="1">
  <comments>One or more entries for specific individuals.  Records WHERE nameChange IS NULL are the current records for any specific individual id.</comments>
 </field>
 <field name="name" data_type="integer" size="10" order="2" />
 <field name="company" data_type="integer" size="10" order="3" />
 <field name="prefix" data_type="integer" size="10" is_nullable="1" order="4" />
 <field name="suffix" data_type="integer" size="10" is_nullable="1" order="5" />
 <field name="goesBy" data_type="varchar" size="40" is_nullable="1" order="6" />
 <field name="birth" data_type="timestamp" size="0" is_nullable="1" order="7">
  <comments>Consider birth and death being event attributes with location, thus time zone information.</comments>
 </field>
 <field name="nameChange" data_type="timestamp" size="0" is_nullable="1" order="8" />
 <field name="death" data_type="timestamp" size="0" is_nullable="1" order="9" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="10" />
</fields>
<indices>
 <index name="individual_id" type="NORMAL" fields="id" />
 <index name="individual_id_name_goesBy" type="NORMAL" fields="id,name,goesBy" />
 <index name="individual_id_company_goesBy" type="NORMAL" fields="id,company,goesBy" />
</indices>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="name" reference_table="Name" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="company" reference_table="Company" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="prefix" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="suffix" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="Email" order="25">
<fields>
 <field name="id" data_type="integer" size="10" is_nullable="0" is_auto_increment="1" is_primary_key="1" order="1" />
 <field name="username" data_type="varchar" size="30" is_nullable="0" order="2" />
 <field name="plus" data_type="varchar" size="30" is_nullable="1" order="3" />
 <field name="host" data_type="varchar" size="30" is_nullable="0" order="4" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="5" />
</fields>
<constraints>
</constraints>
</table>

<table name="untestedIndividualList" order="30">
<fields>
 <field name="id" data_type="integer" size="10" is_nullable="1" order="1" />
 <field name="unlist" data_type="timestamp" size="0" is_nullable="1" order="2" />
 <field name="individual" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="4" />
</fields>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="id" reference_table="untestedIndividualListName" reference_fields="individualList" deferrable="1" />
</constraints>
</table>

<table name="untestedIndividualListName" order="31">
<fields>
 <field name="individualList" data_type="integer" size="10" is_nullable="0" is_auto_increment="1" is_primary_key="1" order="1" />
 <field name="name" data_type="integer" size="10" is_nullable="0" order="2" />
 <field name="sequence" data_type="smallint" size="5" is_nullable="0" order="2" />
 <field name="optinStyle" data_type="smallint" size="1" is_nullable="0" order="2">
  <comments>optin or optout style list</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<constraints>
</constraints>
</table>


<comments>
untested[TableName] are tables that should work, but are un-tested.  Use at your own risk
unfinished[TableName] are tables that are mostly place holders or note taking.  These should not be used and are probably completely wrong.
</comments>

<table name="untestedSchemaVersion" order="999">
<fields>
 <field name="major" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="minor" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="patch" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>


<table name="untestedPath" order="999">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="protocal" data_type="varchar" size="4" is_nullable="1" order="2" />
 <field name="secure" data_type="smallint" size="1" is_nullable="1" order="3" />
 <field name="host" data_type="varchar" size="30" is_nullable="1" order="4" />
 <field name="value" data_type="varchar" size="30" is_nullable="1" order="5" />
 <field name="get" data_type="varchar" size="30" is_nullable="1" order="6" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>


<table name="untestedAttribute" order="999">
<comments>Try for non-duplicated name value pares</comments>
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="name" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="value" data_type="integer" size="10" is_nullable="1" order="3" />
</fields>
</table>


<table name="unfinishedArea" order="9999">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="name" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="shape" data_type="bytea" size="100" is_nullable="1" order="3" />
 <field name="timezone" data_type="varchar" size="30" is_nullable="1" order="3" />
</fields>
</table>

<table name="unfinishedLocation" order="9999">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="parent" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="marquee" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="latitude" data_type="float" size="10" is_nullable="1" order="3" />
 <field name="longitude" data_type="float" size="10" is_nullable="1" order="3" />
 <field name="level" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="altitudeFeetAboveSeaLevel" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="area" data_type="integer" size="10" is_nullable="1" order="3" />
</fields>
</table>

<table name="unfinishedCountry" order="9999">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="code" data_type="varchar" size="4" is_nullable="1" order="3" />
 <field name="dial" data_type="varchar" size="8" is_nullable="1" order="3" />
 <field name="name" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="location" data_type="integer" size="10" is_nullable="1" order="3" />
</fields>
</table>

<table name="unfinishedPostal" order="9999">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="country" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="code" data_type="varchar" size="10" is_nullable="1" order="3" />
 <field name="state" data_type="varchar" size="4" is_nullable="1" order="3">
  <comments>Province Territory or Zone</comments>
 </field>
 <field name="city" data_type="varchar" size="40" is_nullable="1" order="3">
  <comments>Township</comments>
 </field>
 <field name="location" data_type="integer" size="10" is_nullable="1" order="3" />
</fields>
</table>

<table name="unfinishedAddress" order="9999">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="line1" data_type="varchar" size="50" is_nullable="1" order="3" />
 <field name="line2" data_type="varchar" size="50" is_nullable="1" order="3" />
 <field name="line3" data_type="varchar" size="50" is_nullable="1" order="3" />
 <field name="line4" data_type="varchar" size="50" is_nullable="1" order="3" />
 <field name="postal" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="postalPlus" data_type="varchar" size="4" is_nullable="1" order="3" />
 <field name="location" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<table name="unfinishedAddressAttribute" order="9999">
<comments>usps address fields for example.  address line source fields.</comments>
<fields>
 <field name="address" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="attribute" data_type="integer" size="10" is_nullable="1" order="3" />
</fields>
</table>

<table name="unfinishedPhone" order="9999">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="number" data_type="varchar" size="20" is_nullable="1" order="3" />
 <field name="country" data_type="integer" size="10" is_nullable="1" order="3" />
</fields>
</table>

<table name="unfinishedIndividualAttribute" order="9999">
<fields>
 <field name="individual" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="attribute" data_type="integer" size="10" is_nullable="1" order="3" />
</fields>
</table>

<table name="unfinishedIndividualProperty" order="9999">
<fields>
 <field name="individual" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="property" data_type="integer" size="10" is_nullable="1" order="3" />
</fields>
</table>

<table name="unfinishedIndividualEMail" order="9999">
<fields>
 <field name="individual" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="first" data_type="smallint" size="1" is_nullable="1" order="3">
  <comments>0 not primary, >0 is true and can be sorted on, null if old and should no longer use</comments>
 </field>
 <field name="type" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="email" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<table name="unfinishedIndividualAddress" order="9999">
<fields>
 <field name="individual" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="first" data_type="smallint" size="1" is_nullable="1" order="3">
  <comments>0 not primary, >0 is true and can be sorted on, null if old and should no longer use</comments>
 </field>
 <field name="type" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="address" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<table name="unfinishedIndividualPath" order="9999">
<comments>Web Site, Social page, feed etc.</comments>
<fields>
 <field name="individual" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="first" data_type="smallint" size="1" is_nullable="1" order="3">
  <comments>0 not primary, >0 is true and can be sorted on, null if old and should no longer use</comments>
 </field>
 <field name="type" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="path" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<table name="unfinishedRelease" order="9999">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="name" data_type="integer" size="10" is_nullable="1" order="3">
  <comments>Tag name/Branch</comments>
 </field>
 <field name="path" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="version" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="revision" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="build" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<table name="unfinishedApplication" order="9999">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="name" data_type="integer" size="10" is_nullable="1" order="2" />
 <field name="goesBy" data_type="varchar" size="40" is_nullable="1" order="6" />
 <field name="path" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<table name="unfinishedApplicationRelease" order="9999">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="application" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="release" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<table name="unfinishedIndividualApplicationCreated" order="9999">
<fields>
 <field name="individual" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="applicationRelease" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="createdBy" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<table name="unfinishedSite" order="9999">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="name" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="application" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>


<table name="unfinishedSiteApplication" order="9999">
<fields>
 <field name="site" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="applicationRelease" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<table name="unfinishedSession" order="9999">
<fields>
 <field name="id" data_type="varchar" size="24" is_nullable="0" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="siteApplication" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="initialized" data_type="smallint" size="1" is_nullable="1" order="3" />
 <field name="timeout" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="items" data_type="bytea" size="10" is_nullable="1" order="3" />
 <field name="touched" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<table name="unfinishedPassword" order="9999">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="provider" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="generator" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="value" data_type="varchar" size="70" is_nullable="1" order="3" />
 <field name="name" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="revoked" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<table name="unfinishedCredential" order="9999">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="individual" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="username" data_type="varchar" size="20" is_nullable="1" order="3" />
 <field name="email" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="password" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="culture" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="revoked" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<table name="unfinishedSessionCredential" order="9999">
<fields>
 <field name="id" data_type="integer" size="12" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="session" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="credential" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="fromAddress" data_type="inet" size="19" is_nullable="1" order="3" />
 <field name="referring" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<table name="unfinishedIndividualSessionCreated" order="9999">
<fields>
 <field name="individual" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="sessionCredential" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>




<comments>Template</comments>
<table name="unfinished" order="9999">
<fields>
 <field name="id" data_type="integer" size="11" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" /> 
 <field name="field" data_type="integer" size="10" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

</tables>
<views>
 <comments>SQLFairy does not handle XML escape codes.  So need to convert post process.</comments>
 <view name="People" fields="individual,name,goesBy,birthday,in_days,fullName,honorific,given,middle,family,suffix,honorificvalue,givenvalue,middlevalue,familyvalue,suffixvalue,birth,death,aged,created" order="1">
 <sql>
SELECT Individual.id AS individual, Name.id AS name,
 COALESCE(goesBy,Given.value,Family.value) AS goesBy,
 birthday(CAST(birth AS date),CAST(NOW() AS date)) AS birthday,
 days_until_birthday(CAST(birth AS date), CAST(NOW() AS date)) AS in_days,
 COALESCE(honorific.value || !apos; !apos;,!apos;!apos;) ||
  COALESCE(Given.value || !apos; !apos;,!apos;!apos;) ||
  COALESCE(middle.value || !apos; !apos;,!apos;!apos;) ||
  COALESCE(Family.value || !apos; !apos;,!apos;!apos;) ||
  COALESCE(suffix.value || !apos; !apos;,!apos;!apos;)
  AS fullName,
 Individual.prefix AS honorific,
 Name.given, Name.middle, Name.family,
 Individual.suffix,
 honorific.value AS honorificValue,
 Given.value AS GivenValue, middle.value AS middleValue, Family.value AS FamilyValue,
 suffix.value AS suffixValue,
 birth, death,
 COALESCE(age(death,birth),age(birth)) AS aged,
 Individual.created
FROM Individual
JOIN Name ON Name.id = Individual.name
LEFT JOIN Given ON Given.id = Name.given
LEFT JOIN Given AS middle ON middle.id = Name.middle
LEFT JOIN Family ON Family.id = Name.family
LEFT JOIN Word AS honorific ON honorific.id = Individual.prefix
 AND honorific.culture = 1033
LEFT JOIN Word AS suffix ON suffix.id = Individual.suffix
 AND suffix.culture = 1033
WHERE Individual.nameChange IS NULL
 OR Individual.nameChange > NOW()
 </sql>
 </view>

 <view name="IndividualPersonEvent" fields="individual,name,honorific,suffix,goesby,birth,death,event" order="2">
 <comments>
  Convert individual table transactions into individual person life events.
  Primarily as an input to the PeopleEvent view.
 </comments>
 <sql>
SELECT DISTINCT Individual.id AS individual,
 Individual.name,
 COALESCE(future.prefix, Individual.prefix) AS honorific,
 COALESCE(future.suffix, Individual.suffix) AS suffix,
 COALESCE(future.goesBy, Individual.goesBy) AS goesBy,
 Individual.birth,
 Individual.death,
 CASE WHEN previous.id IS NULL THEN
  -- Check for single event
  CASE WHEN future.id IS NULL THEN
   COALESCE(Individual.death,Individual.nameChange,Individual.birth)
  ELSE
   -- Check for individual attribute change only
   CASE WHEN (future.goesBy != Individual.goesBy)
     OR (future.goesBY IS NOT NULL AND Individual.goesBy IS NULL)
     OR (future.goesBY IS NULL AND Individual.goesBy IS NOT NULL)
     OR (future.prefix != Individual.prefix)
     OR (future.goesBY IS NOT NULL AND Individual.prefix IS NULL)
     OR (future.goesBY IS NULL AND Individual.prefix IS NOT NULL)
     OR (future.suffix != Individual.suffix)
     OR (future.goesBY IS NOT NULL AND Individual.suffix IS NULL)
     OR (future.goesBY IS NULL AND Individual.suffix IS NOT NULL)
   THEN
    -- individual attriute change only
    Individual.nameChange
   ELSE
    Individual.birth
   END
  END
 ELSE
  CASE WHEN future.id IS NULL THEN
   COALESCE(Individual.death,previous.nameChange,Individual.nameChange,Individual.birth)
  ELSE
   Individual.nameChange
  END
 END AS event
FROM Individual
CROSS JOIN Name
LEFT JOIN Individual AS previous ON previous.id = Individual.id
 AND (
  (COALESCE(previous.nameChange,previous.death) !lt; COALESCE(Individual.nameChange,Individual.death))
  OR
  (Individual.death IS NULL AND Individual.nameChange IS NULL
   AND previous.nameChange IS NOT NULL)
 )
LEFT JOIN Individual AS future ON future.id = Individual.id
 AND COALESCE(future.nameChange,future.birth) !gt;= COALESCE(Individual.nameChange,Individual.death)
 AND future.death IS NULL
WHERE Name.id = Individual.name
 </sql>
 </view>

 <view name="PeopleEvent" fields="individual,name,goesby,fullname,date,event,eventname,honorific,given,middle,family,suffix,honorificvalue,givenvalue,middlevalue,familyvalue,suffixvalue" order="3">
 <sql>
SELECT IndividualPersonEvent.individual, IndividualPersonEvent.name,
 COALESCE(IndividualPersonEvent.goesBy,Given.value,Family.value) AS goesBy,
 COALESCE(honorific.value || !apos; !apos;,!apos;!apos;) ||
  COALESCE(Given.value || !apos; !apos;,!apos;!apos;) ||
  COALESCE(middle.value || !apos; !apos;,!apos;!apos;) ||
  COALESCE(Family.value || !apos; !apos;,!apos;!apos;) ||
  COALESCE(suffix.value || !apos; !apos;,!apos;!apos;)
  AS fullName,
 event AS date,
 COALESCE(born.id, death.id, change.id) AS event,
 COALESCE(born.value, death.value, change.value) AS eventName,
 IndividualPersonEvent.honorific,
 Name.given,
 Name.middle,
 Name.family,
 IndividualPersonEvent.suffix,
 honorific.value AS honorificValue,
 Given.value AS GivenValue,
 middle.value AS middleValue,
 Family.value AS FamilyValue,
 suffix.value AS suffixValue
FROM IndividualPersonEvent
 JOIN Name ON Name.id = IndividualPersonEvent.name
 LEFT JOIN Given On Given.id = Name.given
 LEFT JOIN Given AS middle ON middle.id = Name.middle
 LEFT JOIN Family ON Family.id = Name.family
 LEFT JOIN Word AS honorific ON honorific.id = IndividualPersonEvent.honorific
  AND honorific.culture = 1033
 LEFT JOIN Word AS suffix ON suffix.id = IndividualPersonEvent.suffix
  AND suffix.culture = 1033
 LEFT JOIN Word AS born ON born.value = !apos;Born!apos; AND born.culture = 1033 AND birth = event
 LEFT JOIN Word AS death ON death.value = !apos;Died!apos; AND death.culture  = 1033 AND death = event
 LEFT JOIN Word AS change ON change.value = !apos;Changed name!apos; AND change.culture  = 1033
 </sql>
 </view>
</views>
<triggers></triggers>
<procedures></procedures>
</schema>
