<schema name="Business" database="MyCo" xmlns="http://sqlfairy.sourceforge.net/sqlfairy.xml">
<comments>The MIT License (MIT) Copyright (c) 2014-2015 Stephen A Jazdzewski</comments>

<tables>
<table name="Culture" order="300">
<fields>
 <field name="code" data_type="smallint" size="" is_nullable="0" is_auto_increment="0" is_primary_key="1" is_foreign_key="1" order="2">
  <comments>Like 1033 http://msdn.microsoft.com/en-us/library/ee825488(v=cs.20).aspx</comments></field>
 <field name="name" data_type="varchar" size="9" is_nullable="0" is_auto_increment="0" is_primary_key="0" order="3">
  <comments>Like en-US</comments></field>
</fields>
<indices>
</indices>
</table>

<table name="Word" order="2">
<comments>Word records with null culture values are identifiers.  Identifiers are managed with the GetIdentifier functions instead of GetWord.</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" />
 <field name="culture" data_type="smallint" size="" is_nullable="1" is_foreign_key="1" default_value="1033" order="2" />
 <field name="value" data_type="varchar" size="20" is_nullable="0" order="3" />
</fields>
<indices>
 <index name="word_id_culture" type="NORMAL" fields="id,culture" />
 <index name="word_id_culture_value" type="UNIQUE" fields="id,culture,value" />
</indices>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="culture" reference_table="Culture" reference_fields="code" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
</constraints>
<comments></comments>
</table>

<table name="Sentence" order="3">
<comments>Sentence records with null culture values are identity phrases.  Phrases are managed with the GetIdentityPhrase.</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" />
 <field name="culture" data_type="smallint" size="" is_nullable="1" is_foreign_key="1" default_value="1033" order="2" />
 <field name="value" data_type="varchar" size="256" is_nullable="0" order="3" />
 <field name="length" data_type="smallint" size="3" is_nullable="1" order="4" >
  <comments>Used for dynamic drop list item sorting</comments>
 </field>
</fields>
<indices>
 <index name="sentence_id_culture" type="NORMAL" fields="id,culture" />
 <index name="sentence_id_culture_value" type="UNIQUE" fields="id,culture,value" />
</indices>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="culture" reference_table="Culture" reference_fields="code" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
</constraints>
<comments></comments>
</table>

<table name="Paragraph" order="4">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" />
 <field name="culture" data_type="smallint" size="" is_nullable="1" is_foreign_key="1" default_value="1033" order="2" />
 <field name="value" data_type="text" size="0" is_nullable="0" order="3" />
</fields>
<indices>
 <index name="paragraph_id_culture" type="NORMAL" fields="id,culture" />
 <index name="paragraph_id_culture_value" type="UNIQUE" fields="id,culture,value" />
</indices>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="culture" reference_table="Culture" reference_fields="code" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
</constraints>
<comments></comments>
</table>

<table name="Timezone" order="302">
<fields>
 <field name="name" data_type="varchar" size="40" is_nullable="0" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="abbrev" data_type="varchar" size="8" is_nullable="0" is_primary_key="0" order="2" />
 <field name="utc_offset" data_type="interval" size="" is_nullable="0" is_auto_increment="0" order="3" />
 <field name="is_dst" data_type="smallint" size="1" is_nullable="0" order="4" />
</fields>
<indices>
 <index name="timezone_name" type="UNIQUE" fields="name" />
</indices>
</table>

<table name="Area" order="300">
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1">
  <comments>Reserve the DMA codes</comments>
 </field>
 <field name="name" data_type="integer" size="" is_nullable="0" order="2" />
 <comments>Add this field if using GIS</comments>
 <comments invalid=""><field name="shape" data_type="GEOMETRY" size="" is_nullable="1" order="3" /></comments>
 <field name="timezone" data_type="varchar" size="40" is_nullable="1" order="4" />
</fields>
<constraints>
 <constraint name="area_timezone" type="FOREIGN KEY" fields="timezone" reference_table="Timezone" reference_fields="name" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="name" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
</constraints>
<indices>
 <index name="area_name_timezone" type="UNIQUE" fields="name,timezone" />
</indices>
</table>

<table name="Location" order="301">
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="parent" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="marquee" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="latitude" data_type="float" size="24" is_nullable="1" order="4" />
 <field name="longitude" data_type="float" size="24" is_nullable="1" order="5" />
 <field name="accuracy" data_type="integer" size="" is_nullable="1" order="6">
  <comments>From GeoNames.org accuracy of lat/lng from 1=estimated to 6=centroid</comments>
 </field>
 <field name="level" data_type="integer" size="" is_nullable="0" default_value="1" order="7">
  <comments>Floor. Negative numbers for basements</comments>
 </field>
 <field name="altitudeAboveSeaLevel" data_type="integer" size="" is_nullable="1" order="8">
  <comments>In meters</comments>
 </field>
 <field name="area" data_type="integer" size="" is_nullable="1" order="9" >
  <comments>For timezone information for small locations</comments>
 </field>
</fields>
<constraints>
 <constraint name="location_area" type="FOREIGN KEY" fields="area" reference_table="Area" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="marquee" reference_table="Sentence" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="Given" order="261">
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="value" data_type="varchar" size="25" is_nullable="0" order="3" />
</fields>
<indices>
 <index name="given_value" type="UNIQUE" fields="value" />
</indices>
<constraints>
</constraints>
<comments></comments>
</table>

<table name="Family" order="261">
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="value" data_type="varchar" size="25" is_nullable="0" order="3" />
</fields>
<indices>
 <index name="family_value" type="UNIQUE" fields="value" />
</indices>
<constraints>
</constraints>
<comments></comments>
</table>

<table name="Name" order="260">
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="given" data_type="integer" size="" is_nullable="1" is_foreign_key="1" order="3" />
 <field name="middle" data_type="integer" size="" is_nullable="1" is_foreign_key="1" order="4" />
 <field name="family" data_type="integer" size="" is_nullable="1" is_foreign_key="1" order="5" />
</fields>
<indices>
 <index name="name_given_middle_family" type="UNIQUE" fields="given,middle,family" />
</indices>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="given" reference_table="Given" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="middle" reference_table="Given" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="family" reference_table="Family" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
</constraints>
</table>

<table name="Entity" order="260">
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="name" data_type="varchar" size="50" is_nullable="1" order="2" />
</fields>
<constraints>
</constraints>
</table>

<table name="Individual" order="250">
<fields>
 <field name="id" data_type="bigint" size="20" is_nullable="0" is_auto_increment="1" is_primary_key="0" order="1">
  <comments>One or more entries for specific individuals.  Records WHERE nameChange IS NULL are the current records for any specific individual id.</comments>
 </field>
 <field name="name" data_type="integer" size="" order="2" />
 <field name="entity" data_type="integer" size="" order="3" />
 <field name="prefix" data_type="integer" size="" is_nullable="1" order="4" />
 <field name="suffix" data_type="integer" size="" is_nullable="1" order="5" />
 <field name="post" data_type="integer" size="" is_nullable="1" order="6" />
 <field name="goesBy" data_type="integer" size="" is_nullable="1" order="7" />
 <field name="birth" data_type="timestamp" size="0" is_nullable="1" order="8">
  <comments>Consider birth and death being event attributes with location, thus time zone information.</comments>
 </field>
 <field name="nameChange" data_type="timestamp" size="0" is_nullable="1" order="9" />
 <field name="death" data_type="timestamp" size="0" is_nullable="1" order="10" />
 <field name="location" data_type="integer" size="" is_nullable="1" order="11" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="12" />
</fields>
<indices>
 <index name="individual_id" type="NORMAL" fields="id" />
</indices>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="name" reference_table="Name" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="entity" reference_table="Entity" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="goesBy" reference_table="Given" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="prefix" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="suffix" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid2" type="FOREIGN KEY" fields="post" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <constraint name="" type="FOREIGN KEY" fields="location" reference_table="Location" reference_fields="id" deferrable="1" />
</constraints>
</table>

<table name="Email" order="270">
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="username" data_type="varchar" size="30" is_nullable="0" order="2" />
 <field name="plus" data_type="varchar" size="30" is_nullable="1" order="3" />
 <field name="host" data_type="varchar" size="30" is_nullable="0" order="4" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="5" />
</fields>
<constraints>
</constraints>
</table>

<table name="Path" order="270">
<fields>
 <field name="id" data_type="bigint" size="20" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="protocol" data_type="varchar" size="4" is_nullable="0" order="2" />
 <field name="secure" data_type="smallint" size="1" is_nullable="0" default_value="0" order="3" />
 <field name="host" data_type="varchar" size="64" is_nullable="1" order="4" />
 <field name="value" data_type="varchar" size="256" is_nullable="1" order="5" />
 <field name="get" data_type="varchar" size="256" is_nullable="1" order="6" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<table name="ListIndividual" order="30">
<fields>
 <field name="id" data_type="integer" size="" is_nullable="1" order="1">
  <comments>NULL applies to all lists.</comments>
 </field>
 <field name="unlist" data_type="timestamp" size="0" is_nullable="1" order="2">
  <comments>Not NULL to remove from list</comments>
 </field>
 <field name="individual" data_type="bigint" size="20" is_nullable="0" order="3" />
 <field name="type" data_type="integer" size="" is_nullable="1" order="4">
   <comments>NULL defaults to To, can also be To, CC and BCC</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="4" />
</fields>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="id" reference_table="ListIndividualName" reference_fields="listIndividual" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="individual" reference_table="Individual" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid2" type="FOREIGN KEY" fields="type" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="ListIndividualName" order="31">
<fields>
 <field name="listIndividual" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="name" data_type="integer" size="" is_nullable="0" order="2" />
 <field name="listSet" data_type="integer" size="" order="3" />
 <field name="sequence" data_type="smallint" size="5" order="4">
  <comments>Order in a displayed list.</comments>
 </field>
 <field name="optinStyle" data_type="smallint" size="1" is_nullable="0" order="5">
  <comments>Optin or optout style list.</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<constraints>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="name" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid2" type="FOREIGN KEY" fields="listSet" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="IndividualPath" order="50">
<comments>Web Site, Social page, feed etc.</comments>
<fields>
 <field name="individual" data_type="bigint" size="20" is_nullable="1" order="1" />
 <field name="type" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="path" data_type="bigint" size="20" is_nullable="1" order="4" />
 <field name="track" data_type="varchar" size="30" is_nullable="1" order="5">
  <comments>Added to end of path in the Get section for tracking links to same path</comments>
 </field>
 <field name="stop" data_type="timestamp" size="0" is_nullable="1" order="6">
  <comments>No longer associate this record with individual.  Used instead of DELETE.</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="path" reference_table="Path" reference_fields="id" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="type" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="individual" reference_table="Individual" reference_fields="id" deferrable="1" /></comments>
</constraints>
<indices>
 <index name="individualpath_individual_type" type="NORMAL" fields="individual,type" />
</indices>
</table>

<table name="IndividualEmail" order="51">
<fields>
 <field name="individual" data_type="bigint" size="20" is_nullable="1" order="1" />
 <field name="type" data_type="integer" size="" is_nullable="1" order="2">
   <comments>type of NULL is the primary or default email address for individual</comments>
 </field>
 <field name="email" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="stop" data_type="timestamp" size="0" is_nullable="1" order="4">
  <comments>No longer associate this record with individual.  Used instead of DELETE.</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="email" reference_table="Email" reference_fields="id" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="type" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="individual" reference_table="Individual" reference_fields="id" deferrable="1" /></comments>
</constraints>
<indices>
 <index name="individualemail_individual_type" type="NORMAL" fields="individual,type" />
</indices>
</table>

<table name="Country" order="303">
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="name" data_type="integer" size="" is_nullable="0" order="2" />
 <field name="code" data_type="varchar" size="4" is_nullable="1" order="3">
  <comments>Long ISO Country code. See http://countrycode.org/</comments>
 </field>
 <field name="idd" data_type="varchar" size="8" is_nullable="1" order="4">
  <comments>International Dialing Prefix. See http://countrycode.org/</comments>
 </field>
 <field name="ndd" data_type="varchar" size="4" is_nullable="1" order="5">
  <comments>Country Code. See http://countrycode.org/</comments>
 </field>
 <field name="location" data_type="integer" size="" is_nullable="1" order="6">
  <comments>For center of country only</comments>
 </field>
</fields>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="location" reference_table="Location" reference_fields="id" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="name" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
</constraints>
<indices>
 <index name="country_name" type="UNIQUE" fields="name" />
</indices>
</table>

<table name="Phone" order="270">
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="country" data_type="integer" size="" is_nullable="0" default_value="1" order="3">
  <comments>Default to USA</comments>
 </field>
 <field name="location" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="area" data_type="varchar" size="4" is_nullable="0" order="3">
  <comments>Strip out all formatting characters.</comments>
 </field>
 <field name="number" data_type="varchar" size="10" is_nullable="0" order="4">
  <comments>Strip out all formatting characters.</comments>
 </field>
</fields>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="country" reference_table="Country" reference_fields="id" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="location" reference_table="Location" reference_fields="id" deferrable="1" />
</constraints>
<indices>
 <index name="phone_country_area_number" type="UNIQUE" fields="country,area,number" />
</indices>
</table>

<table name="IndividualPhone" order="65">
<fields>
 <field name="individual" data_type="bigint" size="20" is_nullable="1" order="1" />
 <field name="type" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="phone" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="stop" data_type="timestamp" size="0" is_nullable="1" order="4">
  <comments>No longer associate this record with individual.  Used instead of DELETE.</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="phone" reference_table="Phone" reference_fields="id" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="type" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="individual" reference_table="Individual" reference_fields="id" deferrable="1" /></comments>
</constraints>
<indices>
 <index name="individualphone_individual_type" type="NORMAL" fields="individual,type" />
</indices>
</table>

<table name="Postal" order="302">
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="country" data_type="integer" size="" is_nullable="0" order="2" />
 <field name="code" data_type="varchar" size="10" is_nullable="0" order="3" />
 <field name="state" data_type="integer" size="" is_nullable="1" order="4">
  <comments>Province Territory or Zone</comments>
 </field>
 <field name="stateAbbreviation" data_type="integer" size="" is_nullable="1" order="5" />
 <field name="county" data_type="integer" size="" is_nullable="1" order="6">
  <comments>Province</comments>
 </field>
 <field name="city" data_type="integer" size="" is_nullable="0" order="7">
  <comments>Township</comments>
 </field>
 <field name="location" data_type="integer" size="" is_nullable="1" order="8" />
</fields>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="country" reference_table="Country" reference_fields="id" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="state" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="stateAbbreviation" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalud2" type="FOREIGN KEY" fields="county" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalud3" type="FOREIGN KEY" fields="city" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <constraint name="" type="FOREIGN KEY" fields="location" reference_table="Location" reference_fields="id" deferrable="1" />
</constraints>
<indices>
 <index name="postal_country_code" type="UNIQUE" fields="country,code" />
</indices>
</table>

<table name="Address" order="71">
<fields>
 <comments>A lot of work needs to be done to be sure duplicate addresses are not entered.  This work will be centered around validation and the AddressAttribute table.</comments>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="line1" data_type="varchar" size="50" is_nullable="1" order="2" />
 <field name="line2" data_type="varchar" size="50" is_nullable="1" order="3" />
 <field name="line3" data_type="varchar" size="50" is_nullable="1" order="4" />
 <field name="line4" data_type="varchar" size="50" is_nullable="1" order="5" />
 <field name="postal" data_type="integer" size="" is_nullable="1" order="6" />
 <field name="postalPlus" data_type="varchar" size="4" is_nullable="1" order="7" />
 <field name="location" data_type="integer" size="" is_nullable="1" order="8" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="9" />
</fields>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="postal" reference_table="Postal" reference_fields="id" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="location" reference_table="Location" reference_fields="id" deferrable="1" />
</constraints>
<indices>
 <index name="address_postal_postalplus_location" type="NORMAL" fields="postal, postalPlus, location" />
</indices>
</table>

<table name="Version" order="999">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="name" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="major" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="minor" data_type="integer" size="" is_nullable="1" order="4" />
 <field name="patch" data_type="integer" size="" is_nullable="1" order="5" />
</fields>
<indices>
 <index name="version_name_major_minor_patch" type="UNIQUE" fields="name,major,minor,patch" />
</indices>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="name" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="major" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid2" type="FOREIGN KEY" fields="minor" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid3" type="FOREIGN KEY" fields="patch" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="Release" order="240">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0"	is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="version" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="build" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="name" data_type="integer" size="" is_nullable="1" order="4">
  <comments>Tag name/Branch</comments>
 </field>
 <field name="path" data_type="bigint" size="20" is_nullable="1" order="5">
  <comments>Repository path</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
 <index name="release_version_build" type="UNIQUE" fields="version,build" />
</indices>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="version" reference_table="Version" reference_fields="id" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="build" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="name" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <constraint name="" type="FOREIGN KEY" fields="path" reference_table="Path" reference_fields="id" deferrable="1" />
</constraints>
</table>

<table name="Application" order="240">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="name" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="goesBy" data_type="varchar" size="40" is_nullable="1" order="3" />
 <field name="path" data_type="bigint" size="20" is_nullable="1" order="4" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
 <index name="application_name" type="UNIQUE" fields="name" />
</indices>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="name" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <constraint name="" type="FOREIGN KEY" fields="path" reference_table="Path" reference_fields="id" deferrable="1" />
</constraints>
</table>

<table name="ApplicationRelease" order="233">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="application" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="release" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
 <index name="application_release" type="UNIQUE" fields="application,release" />
</indices>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="application" reference_table="Application" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="release" reference_table="Release" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
</constraints>
</table>

<table name="Part" order="131">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="parent" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="name" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="version" data_type="integer" size="" is_nullable="1" order="4" />
 <field name="serial" data_type="varchar" is_nullable="1" order="5" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
 <index name="part_parent_name_version_serial" type="UNIQUE" fields="parent,name,version,serial" />
</indices>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="parent" reference_table="Part" reference_fields="id" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="name" reference_table="Sentence" reference_fields="id" deferrable="1" /></comments>
 <constraint name="" type="FOREIGN KEY" fields="version" reference_table="Version" reference_fields="id" deferrable="1" />
</constraints>
</table>

<table name="AssemblyPart" order="130">
<comments>untested</comments>
<fields>
 <field name="assembly" data_type="integer" size="" is_nullable="1" order="1" />
 <field name="part" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="designator" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="quantity" data_type="integer" size="" is_nullable="1" order="4" />
</fields>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="assembly" reference_table="Part" reference_fields="id" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="part" reference_table="Part" reference_fields="id" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="designator" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="PartDescription" order="132">
<fields>
 <field name="part" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="description" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<constraints>
  <constraint name="" type="FOREIGN KEY" fields="part" reference_table="Part" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="description" reference_table="Paragraph" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<comments>A client device and its operating system. Change to AssemblyApplicationRelease</comments>
<table name="AssemblyApplicationRelease" order="140">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="parent" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="assembly" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="applicationRelease" data_type="integer" size=""	is_nullable="1" order="4" />
 <field name="name" data_type="integer" size="" is_nullable="1" order="5" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
 <index name="AssemblyApplicationRelease_assembly_applicationRelease_parent" type="UNIQUE" fields="assembly,applicationRelease,parent" />
 <index name="AssemblyApplicationRelease_applicationRelease" type="NORMAL" fields="applicationRelease" />
</indices>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="parent" reference_table="AssemblyApplicationRelease" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="assembly" reference_table="Part" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="applicationRelease" reference_table="ApplicationRelease" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="name" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="Site" order="211">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="name" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="name" reference_table="Sentence" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>


<comments>Information about when etc. site got particular released application</comments>
<table name="SiteApplicationRelease" order="210">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="site" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="applicationRelease" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="site" reference_table="Site" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="applicationRelease" reference_table="ApplicationRelease" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
</constraints>
</table>

<table name="Session" order="220">
<comments>untested</comments>
<fields>
 <field name="id" data_type="bigint" size="20" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="lock" data_type="integer" size="" default_value="0" is_nullable="0" order="3">
  <comments>Mono System.Web/ASPState.sql style locks</comments>
 </field>
 <field name="touched" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="98" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
</indices>
<constraints>
</constraints>
</table>

<table name="SessionToken" order="209">
<comments>untested</comments>
<fields>
 <field name="session" data_type="bigint" size="20" is_nullable="0" is_primary_key="0" is_foreign_key="0" order="1" />
 <field name="token" data_type="varchar" size="32" is_nullable="0" is_foreign_key="0" order="1" />
 <field name="siteApplicationRelease" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="initialized" data_type="smallint" size="1" is_nullable="1" order="3" />
 <field name="timeout" data_type="integer" size="" is_nullable="1" order="4" />
 <field name="items" data_type="bytea" size="10" is_nullable="1" order="5" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
 <index name="sessionToken_session_siteApplicationRelease" type="UNIQUE" fields="session,siteApplicationRelease" />
 <index name="sessionToken_session_token" type="UNIQUE" fields="session,token" />
</indices>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="session" reference_table="Session" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="siteApplicationRelease" reference_table="SiteApplicationRelease" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
</constraints>
</table>

<table name="Password" order="232">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="provider" data_type="bigint" size="20" is_nullable="1" order="2" />
 <field name="generator" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="value" data_type="text" size="" is_nullable="1" order="4" />
 <field name="name" data_type="integer" size="" is_nullable="1" order="5" />
 <field name="revoked" data_type="timestamp" size="0" is_nullable="1" order="98" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="provider" reference_table="Individual" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" /></comments>
 <constraint name="" type="FOREIGN KEY" fields="generator" reference_table="ApplicationRelease" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="name" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="Credential" order="231">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="individual" data_type="bigint" size="20" is_nullable="1" order="2" />
 <field name="username" data_type="varchar" size="20" is_nullable="1" order="3" />
 <field name="email" data_type="integer" size="" is_nullable="1" order="4" />
 <field name="password" data_type="integer" size="" is_nullable="1" order="5" />
 <field name="culture" data_type="smallint" size="" is_nullable="1" order="6" />
 <field name="revoked" data_type="timestamp" size="0" is_nullable="1" order="98" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
 <index name="credential_individual" type="NORMAL" fields="individual" />
</indices>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="individual" reference_table="Individual" reference_fields="id" deferrable="1" /></comments>
 <constraint name="" type="FOREIGN KEY" fields="email" reference_table="Email" reference_fields="id" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="password" reference_table="Password" reference_fields="id" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="culture" reference_table="Culture" reference_fields="code" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
</constraints>
</table>

<table name="AgentString" order="232">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="agent" data_type="integer" size="" is_nullable="1" order="5">
  <comments>Browser user agent string raw</comments>
 </field>
 <field name="userAgentString" data_type="integer" size="" is_nullable="1" order="4">
  <comments>Browser user agent string parsed into agent</comments>
 </field>
</fields>
<indices>
 <index name="agentString_agent_useragentstring" type="UNIQUE" fields="agent,userAgentString" />
</indices>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="agent" reference_table="AssemblyApplicationRelease" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="userAgentString" reference_table="Sentence" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="SessionCredential" order="219">
<comments>untested</comments>
<fields>
 <field name="id" data_type="bigint" size="20" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="session" data_type="bigint" size="20" is_nullable="0" order="2" />
 <field name="agentString" data_type="integer" size="" is_nullable="1" order="4" />
 <field name="credential" data_type="integer" size="" is_nullable="1" order="5" />
 <field name="referring" data_type="bigint" size="20" is_nullable="1" order="6" />
 <field name="fromAddress" data_type="inet" size="19" is_nullable="1" order="7" />
 <field name="location" data_type="integer" size="" is_nullable="1" order="8" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="session" reference_table="Session" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="agentString" reference_table="AgentString" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="credential" reference_table="Credential" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="referring" reference_table="Path" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <constraint name="" type="FOREIGN KEY" fields="location" reference_table="Location" reference_fields="id" deferrable="1" />
</constraints>
</table>

<table name="Attribute" order="801">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="0" order="1" />
 <field name="unit" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="word" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="integer" data_type="integer" size="" is_nullable="1" order="4" />
 <field name="float" data_type="float" size="24" is_nullable="1" order="5" />
 <field name="dateTime" data_type="timestamp" size="0" is_nullable="1" order="6" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="10" />
</fields>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="unit" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="word" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="RecordProperty" order="800">
<comments>untested</comments>
<fields>
 <field name="tableName" data_type="varchar" size="64" is_nullable="0" order="1" />
 <field name="tableId" data_type="bigint" size="20" is_nullable="1" order="2">
  <comment>tableId is null for list of possible properties/attributes for table</comment>
 </field>
 <field name="property" data_type="integer" size="" is_nullable="0" order="3" />
 <field name="attribute" data_type="integer" size="" is_nullable="1" order="4">
  <comment>attribute is null if just a property</comment>
 </field>
 <field name="stop" data_type="timestamp" size="0" is_nullable="1" order="5" >
  <comments>No longer associate with this record.  Used instead of DELETE.</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="10" />
</fields>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="attribute" reference_table="Attribute" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="property" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<comments>Tables to define periods of time</comments>
<table name="Period" order="300">
<fields>
 <field name="id" data_type="integer" size="" is_nullable="1" is_auto_increment="1" is_primary_key="0" is_foreign_key="1" order="1" />
 <field name="span" data_type="integer" size="" is_nullable="0" is_foreign_key="1" order="2" />
 <field name="exclude" data_type="boolean" size="" is_nullable="0" default_value="false" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<comments>Span tables share the same unique sequence id</comments>
<table name="DateRange" order="310">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="0" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="start" data_type="timestamp WITHOUT TIME ZONE" size="0" is_nullable="0" order="2" />
 <field name="stop" data_type="timestamp WITHOUT TIME ZONE" size="0" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<table name="TimeOfDay" order="311">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="0" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="start" data_type="time WITHOUT TIME ZONE" size="0" is_nullable="0" order="2" />
 <field name="stop" data_type="time WITHOUT TIME ZONE" size="0" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="id" reference_table="Period" reference_fields="span" deferrable="1" /></comments>
</constraints>
</table>

<table name="DayOfWeek" order="312">
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="0" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="start" data_type="smallint" size="" is_nullable="1" order="2" />
 <field name="stop" data_type="smallint" size="" is_nullable="1" order="3" />
 <field name="dayOfMonth" data_type="integer" is_nullable="1" order="4" >
  <comments>Positive or negative day in the month. 1st Thursday, last Friday,  etc</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="id" reference_table="Period" reference_fields="span" deferrable="1" /></comments>
</constraints>
</table>

<table name="MonthDay" order="313">
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="0" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="month" data_type="smallint" size="0" is_nullable="1" order="2" />
 <field name="day" data_type="smallint" size="0" is_nullable="1" order="3" />
 <field name="weekOfMonth" data_type="integer" is_nullable="1" order="4" >
  <comments>Positive or negative week in the month. 1st week, last week,  etc</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="id" reference_table="Period" reference_fields="span" deferrable="1" /></comments>
</constraints>
</table>

<table name="Month" order="314">
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="0" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="month" data_type="smallint" size="0" is_nullable="1" order="2" >
  <comments>January is 1, December is 12</comments>
 </field>
 <field name="year" data_type="integer" size="0" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="id" reference_table="Period" reference_fields="span" deferrable="1" /></comments>
</constraints>
</table>

<table name="PeriodName" order="390">
<fields>
 <field name="period" data_type="integer" size="" is_nullable="0" is_auto_increment="0" is_primary_key="0" is_foreign_key="0" order="1" />
 <field name="name" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
 <index name="periodname_name" type="NORMAL" fields="name" />
 <index name="periodname_period" type="NORMAL" fields="period" />
</indices>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="period" reference_table="Period" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="name" reference_table="Sentence" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>


<table name="SchemaVersion" order="990">
<comments>untested</comments>
<fields>
 <field name="build" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" />
 <field name="schema" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="version" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<constraints>
 <constraint name="" type="FOREIGN KEY" fields="version" reference_table="Version" reference_fields="id" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="schema" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>


<comments>
Tables below are unfinished and are mostly place holders or note taking.  These should not be used and are probably completely wrong.
</comments>


<table name="AddressAttribute" order="72">
<comments>usps address fields for example.  address line source fields.</comments>
<fields>
 <field name="address" data_type="integer" size="" is_nullable="0" order="3" />
 <field name="attribute" data_type="integer" size="" is_nullable="0" order="3" />
 <field name="value" data_type="integer" size="" is_nullable="0" order="3" />
</fields>
</table>

<table name="IndividualAddress" order="75">
<comments>untested</comments>
<fields>
 <field name="individual" data_type="bigint" size="20" is_nullable="1" order="3" />
 <field name="type" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="address" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="stop" data_type="timestamp" size="0" is_nullable="1" order="3">
  <comments>No longer associate this record with individual.  Used instead of DELETE.</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
 <index name="individualAddress_individual_stop" type="NORMAL" fields="individual,stop" />
</indices>
<constraints>
 <constraint name="individualAddress_address" type="FOREIGN KEY" fields="address" reference_table="Address" reference_fields="id" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="individual" reference_table="Individual" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="type" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="IndividualApplicationCreated" order="211">
<comments>untested</comments>
<fields>
 <field name="individual" data_type="bigint" size="20" is_nullable="1" order="3" />
 <field name="applicationRelease" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="createdBy" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="stop" data_type="timestamp" size="0" is_nullable="1" order="3">
  <comments>No longer associate this record with individual.  Used instead of DELETE.</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
</table>

<table name="IndividualSessionCreated" order="218">
<comments>untested</comments>
<fields>
 <field name="individual" data_type="bigint" size="20" is_nullable="1" order="3" />
 <field name="sessionCredential" data_type="bigint" size="20" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="individual" reference_table="Individual" reference_fields="id" deferrable="1" /></comments>
 <constraint name="" type="FOREIGN KEY" fields="sessionCredential" reference_table="SessionCredential" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
</constraints>
</table>

<comments>Double Entry Accounting</comments>
<table name="LedgerName" order="900">
<comments>untested</comments>
<fields>
 <field name="ledger" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="name" data_type="integer" size="" is_nullable="0" order="2" />
</fields>
<indices>
</indices>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="name" reference_table="Sentence" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="JournalName" order="900">
<comments>untested</comments>
<fields>
 <field name="journal" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="name" data_type="integer" size="" is_nullable="0" order="2" />
</fields>
<indices>
</indices>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="name" reference_table="Sentence" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="BookName" order="900">
<comments>untested</comments>
<fields>
 <field name="book" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="name" data_type="integer" size="" is_nullable="0" order="2" />
 <field name="journal" data_type="integer" size="" is_nullable="0" order="1" />
</fields>
<indices>
</indices>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="name" reference_table="Sentence" reference_fields="id" deferrable="1" /></comments>
 <constraint name="bookname_journal" type="FOREIGN KEY" fields="journal" reference_table="JournalName" reference_fields="journal" deferrable="1" />
</constraints>
</table>

<table name="AccountName" order="900">
<comments>untested</comments>
<fields>
 <field name="account" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="name" data_type="integer" size="" is_nullable="0" order="2" />
 <field name="type" data_type="integer" size="" is_nullable="0" order="3">
   <comments>Used in conjunction with the credit field.
    Account.type, Account.credit
    Asset, false
    Liability, true
    Equity, true
    Income, true
    Expense, false
    Dividend, false
    Share, true
    Retained, true
   Contra accounts have same type but invert the credit value.
   </comments>
 </field>
 <field name="credit" data_type="boolean" size="" is_nullable="0" order="4">
  <comments>True if increases the credit column otherwise increas the debit column</comments>
 </field>
 <field name="amount" data_type="float" is_nullable="1" order="5">
  <comments>Default amount if JournalAccount.amout IS NULL</comments>
 </field>
</fields>
<indices>
</indices>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="name" reference_table="Sentence" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="type" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="JobName" order="900">
<comments>untested</comments>
<fields>
 <field name="job" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="name" data_type="integer" size="" is_nullable="0" order="2" />
</fields>
<indices>
</indices>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="name" reference_table="Sentence" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="ScheduleName" order="900">
<comments>untested</comments>
<fields>
 <field name="schedule" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="name" data_type="integer" size="" is_nullable="0" order="2" />
</fields>
<indices>
</indices>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="name" reference_table="Sentence" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="IndividualLedger" order="900">
<comments>untested</comments>
<fields>
 <field name="individual" data_type="bigint" size="20" is_nullable="0" order="1" />
 <field name="ledger" data_type="integer" size="" is_nullable="0" order="2" />
 <field name="stop" data_type="timestamp" size="0" is_nullable="1" order="10">
  <comments>No longer associate this individual with ledger.  Used instead of DELETE.</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
</indices>
<constraints>
 <constraint name="individualledger_ledger" type="FOREIGN KEY" fields="ledger" reference_table="LedgerName" reference_fields="ledger" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="individual" reference_table="Individual" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="Entry" order="900">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="assemblyApplicationRelease" data_type="integer" is_nullable="1" order="2" />
 <field name="credential" data_type="integer" is_nullable="1" order="3" />
</fields>
<indices>
</indices>
<constraints>
 <constraint name="entry_assemblyapplicationrelease" type="FOREIGN KEY" fields="assemblyApplicationRelease" reference_table="AssemblyApplicationRelease" reference_fields="id" deferrable="1" />
 <constraint name="entry_credential" type="FOREIGN KEY" fields="credential" reference_table="Credential" reference_fields="id" deferrable="1" />
</constraints>
</table>

<table name="LedgerAccount" order="901">
<comments>untested</comments>
<fields>
 <field name="ledger" data_type="integer" size="" is_nullable="0" order="1" />
 <field name="account" data_type="integer" size="" is_nullable="0" order="2">
  <comments>T Account</comments>
 </field>
 <field name="stop" data_type="timestamp" size="0" is_nullable="1" order="10">
  <comments>No longer associate this ledger with account.  Used instead of DELETE.</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
</indices>
<constraints>
 <constraint name="ledgeraccount_ledger" type="FOREIGN KEY" fields="ledger" reference_table="LedgerName" reference_fields="ledger" deferrable="1" />
 <constraint name="ledgeraccount_account" type="FOREIGN KEY" fields="account" reference_table="AccountName" reference_fields="account" deferrable="1" />
</constraints>
</table>

<table name="LedgerJournal" order="901">
<comments>untested</comments>
<fields>
 <field name="ledger" data_type="integer" size="" is_nullable="0" order="1" />
 <field name="journal" data_type="integer" size="" is_nullable="0" order="2" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
</indices>
<constraints>
 <constraint name="ledgerjournal_ledger" type="FOREIGN KEY" fields="ledger" reference_table="LedgerName" reference_fields="ledger" deferrable="1" />
 <constraint name="ledgerjournal_journal" type="FOREIGN KEY" fields="journal" reference_table="JournalName" reference_fields="journal" deferrable="1" />
</constraints>
</table>


<table name="JournalAccount" order="901">
<comments>untested</comments>
<fields>
 <field name="journal" data_type="integer" size="" is_nullable="0" order="1" />
 <field name="credit" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="debit" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="amount" data_type="float" is_nullable="1" order="4">
  <comments>Default amount if JournalEntry.amount IS NULL</comments>
 </field>
 <field name="split" data_type="float" is_nullable="1" order="5">
  <comments>% of amount to the credit/debit account[s]. Must specify credit and debit accounts if split is NULL (100% amount to both)</comments>
 </field>
 <field name="stop" data_type="timestamp" size="0" is_nullable="1" order="10">
  <comments>No longer associate accounts with journal.  Used instead of DELETE.</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
</indices>
<constraints>
 <constraint name="journalaccount_journal" type="FOREIGN KEY" fields="journal" reference_table="JournalName" reference_fields="journal" deferrable="1" />
 <constraint name="journalaccount_credit" type="FOREIGN KEY" fields="credit" reference_table="AccountName" reference_fields="account" deferrable="1" />
 <constraint name="journalaccount_debit" type="FOREIGN KEY" fields="debit" reference_table="AccountName" reference_fields="account" deferrable="1" />
</constraints>
</table>
<comments>TODO reconcile with above</comments>
<table name="BookAccount" order="901">
<comments>untested</comments>
<fields>
 <field name="book" data_type="integer" size="" is_nullable="0" order="1" />
 <field name="increase" data_type="integer" size="" is_nullable="1" order="2" />
 <field name="decrease" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="amount" data_type="float" is_nullable="1" order="4">
  <comments>Default amount if JournalEntry.amount IS NULL</comments>
 </field>
 <field name="split" data_type="float" is_nullable="1" order="5">
  <comments>% of amount to the credit/debit account[s]. Must specify credit and debit accounts if split is NULL (100% amount to both)</comments>
 </field>
 <field name="stop" data_type="timestamp" size="0" is_nullable="1" order="10">
  <comments>No longer associate accounts with book.  Used instead of DELETE.</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
</indices>
<constraints>
 <constraint name="bookaccount_book" type="FOREIGN KEY" fields="book" reference_table="BookName" reference_fields="book" deferrable="1" />
 <constraint name="bookaccount_increase" type="FOREIGN KEY" fields="increase" reference_table="AccountName" reference_fields="account" deferrable="1" />
 <constraint name="bookaccount_decrease" type="FOREIGN KEY" fields="decrease" reference_table="AccountName" reference_fields="account" deferrable="1" />
</constraints>
</table>

<table name="JournalEntry" order="901">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="journal" data_type="integer" size="" is_nullable="0" order="4" />
 <field name="book" data_type="integer" size="" is_nullable="1" order="5" />
 <field name="entry" data_type="integer" size="" is_nullable="1" order="6">
  <comments>Group a set of journal entries</comments>
 </field>
 <field name="account" data_type="integer" size="" is_nullable="0" order="7" />
 <field name="credit" data_type="boolean" size="" is_nullable="0" order="8">
  <comments>True if increases the credit column otherwise increas the debit column</comments>
 </field>
 <field name="amount" data_type="float" is_nullable="1" order="9">
  <comments>COALESCE(amount, JournalAccount.amount, AccountName.amount) to get actual transaction amount.</comments>
 </field>
 <field name="posted" data_type="timestamp" is_nullable="1" order="10">
  <comments>Posted to General Ledger</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
</indices>
<constraints>
 <constraint name="journalentry_journal" type="FOREIGN KEY" fields="journal" reference_table="JournalName" reference_fields="journal" deferrable="1" />
 <constraint name="journalentry_book" type="FOREIGN KEY" fields="book" reference_table="BookName" reference_fields="book" deferrable="1" />
 <constraint name="journalentry_entry" type="FOREIGN KEY" fields="entry" reference_table="Entry" reference_fields="id" deferrable="1" />
 <constraint name="hournalentry_account" type="FOREIGN KEY" fields="account" reference_table="AccountName" reference_fields="account" deferrable="1" />
</constraints>
</table>

<table name="IndividualAssemblyCost" order="901">
<comments>untested</comments>
<fields>
 <field name="individual" data_type="bigint" size="20" is_nullable="0" order="1" />
 <field name="assembly" data_type="integer" size="" is_nullable="1" order="2">
   <comments>Default for all assemblies if NULL</comments>
 </field>
 <field name="cost" data_type="float" is_nullable="0" order="3" />
 <field name="stop" data_type="timestamp" size="0" is_nullable="1" order="10">
  <comments>No longer associate this cost with indiviudal assembly</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
</indices>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="individual" reference_table="Individual" reference_fields="id" deferrable="1" /></comments>
 <constraint name="" type="FOREIGN KEY" fields="assembly" reference_table="Part" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
</constraints>
</table>

<table name="IndividualAssemblyCustomerPrice" order="901">
<comments>untested</comments>
<fields>
 <field name="individual" data_type="bigint" size="20" is_nullable="0" order="1" />
 <field name="assembly" data_type="integer" size="" is_nullable="1" order="2">
  <comments>Default for all assemblies if NULL</comments>
 </field>
 <field name="customer" data_type="bigint" size="20" is_nullable="1" order="3">
  <comments>Default price for all customers if NULL</comments>
 </field>
 <field name="price" data_type="float" is_nullable="0" order="4" />
 <field name="stop" data_type="timestamp" size="0" is_nullable="1" order="10">
  <comments>No longer associate this price with indiviudal assembly</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
</indices>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="individual" reference_table="Individual" reference_fields="id" deferrable="1" /></comments>
 <constraint name="" type="FOREIGN KEY" fields="assembly" reference_table="Part" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="customer" reference_table="Individual" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="Schedule" order="901">
<comments>untested</comments>
<fields>
 <field name="schedule" data_type="integer" size="" is_nullable="0" order="1" />
 <field name="period" data_type="integer" size="" is_nullable="1" is_auto_increment="0" is_primary_key="0" is_foreign_key="0" order="2" />
 <field name="fromCount" data_type="float" is_nullable="1" order="3" />
 <field name="toCount" data_type="float" is_nullable="1" order="4" />
 <field name="fromAmount" data_type="float" is_nullable="1" order="5" />
 <field name="toAmount" data_type="float" is_nullable="1" order="6" />
 <field name="rate" data_type="float" is_nullable="1" order="7">
  <comments>% of Cargo.count x Cargo.amount</comments>
 </field>
 <field name="rateCost" data_type="float" is_nullable="1" order="8">
  <comments>% of Cargo.count x Cargo.amount</comments>
 </field>
 <field name="price" data_type="float" is_nullable="1" order="9">
  <comments>Price per Cargo.count</comments>
 </field>
 <field name="cost" data_type="float" is_nullable="1" order="10">
  <comments>Cost per Cargo.count</comments>
 </field>
 <field name="costAccount" data_type="integer" size="" is_nullable="1" order="11" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
</indices>
<constraints>
 <constraint name="schedule_schedule" type="FOREIGN KEY" fields="schedule" reference_table="ScheduleName" reference_fields="schedule" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="period" reference_table="Period" reference_fields="id" deferrable="1" /></comments>
 <constraint name="schedual_costAccount" type="FOREIGN KEY" fields="costAccount" reference_table="AccountName" reference_fields="account" deferrable="1" />
</constraints>
</table>

<table name="JobIndividual" order="901">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="0" order="1">
  <comments>Not unique.  Used to group one or more individuals and/or schedules together for a single corgo record</comments>
 </field>
 <field name="job" data_type="integer" size="" is_nullable="0" order="2" />
 <field name="individual" data_type="bigint" size="20" is_nullable="1" order="3">
  <comments>NULL if a service fee</comments>
 </field>
 <field name="schedule" data_type="integer" size="" is_nullable="1" order="4" />
 <field name="aggregate" data_type="integer" size="" is_nullable="1" order="5">
  <comments>NULL if schedule shown in detail, otherwise group together under this name</comments>
 </field>
 <field name="stop" data_type="timestamp" size="0" is_nullable="1" order="10">
  <comments>No longer associate this record with job.  Used instead of DELETE.</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
</indices>
<constraints>
 <constraint name="jobindividual_job" type="FOREIGN KEY" fields="job" reference_table="JobName" reference_fields="job" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="individual" reference_table="Individual" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="schedule" reference_table="ScheduleName" reference_fields="schedule" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid2" type="FOREIGN KEY" fields="aggregate" reference_table="Sentence" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="Bill" order="901">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="1" is_foreign_key="1" order="1" />
 <field name="type" data_type="integer" size="" is_nullable="1" order="2">
   <comments>Wish, Cart, Quote, Order, Invoice, Lading, Payment, Memo, Return</comments>
 </field>
 <field name="supplier" data_type="bigint" size="20" is_nullable="0" order="3">
  <comments>IndividualAssemblyCost.individual</comments>
 </field>
 <field name="sent" data_type="timestamp" is_nullable="1" order="4" />
 <field name="shipper" data_type="bigint" size="20" is_nullable="1" order="5" />
 <field name="received" data_type="timestamp" is_nullable="1" order="6" />
 <field name="carrier" data_type="bigint" size="20" is_nullable="1" order="7" />
 <field name="loaded" data_type="timestamp" is_nullable="1" order="8" />
 <field name="consignee" data_type="bigint" size="20" is_nullable="0" order="9">
  <comments>IndividualAssemblyCustomerPrice.individual</comments>
 </field>
 <field name="delivered" data_type="timestamp" is_nullable="1" order="10" />
 <field name="clean" data_type="timestamp" is_nullable="1" order="20">
  <comments>Posted without discrepency between sent and delivered</comments>
 </field>
 <field name="dirty" data_type="timestamp" is_nullable="1" order="21">
  <comments>Posted with discrepency between sent and delivered. Not all CargoState records account for Cargo counts</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
</indices>
<constraints>
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="type" reference_table="Word" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="supplier" reference_table="Individual" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid2" type="FOREIGN KEY" fields="shipper" reference_table="Individual" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid3" type="FOREIGN KEY" fields="carrier" reference_table="Individual" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid4" type="FOREIGN KEY" fields="consignee" reference_table="Individual" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="Cargo" order="901">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="1" order="1">
  <comments>Not unique. Cargo lines can be adjusted before Bill.clean or Bill.dirty</comments>
 </field>
 <field name="bill" data_type="integer" is_nullable="0" order="2" />
 <field name="count" data_type="float" is_nullable="1" order="3">
  <comments>NULL is count 1</comments>
 </field>
 <field name="assembly" data_type="integer" size="" is_nullable="1" order="4">
   <comments>NULL if Job</comments>
 </field>
 <field name="jobIndividual" data_type="integer" size="" is_nullable="1" order="5">
   <comments>NULL if Assembly</comments>
 </field>
 <field name="amount" data_type="float" is_nullable="1" order="6">
    <comments>Line item total is count x amount. Overrides IndividualAssemblyCustomerPrice.price or JobIndividual.schedule</comments>
 </field>
 <field name="cost" data_type="float" is_nullable="1" order="7">
    <comments>Line item total cost is count x cost. Overrides IndividualAssemblyCost or JobIndividual.schedule</comments>
 </field>
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
</indices>
<constraints>
 <constraint name="cargo_bill" type="FOREIGN KEY" fields="bill" reference_table="Bill" reference_fields="id" deferrable="1" />
 <constraint name="cargo_assembly" type="FOREIGN KEY" fields="assembly" reference_table="Part" reference_fields="id" on_delete="" on_update="" match_type="" expression="" options="" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="jobIndividual" reference_table="JobIndividual" reference_fields="id" deferrable="1" /></comments>
</constraints>
</table>

<table name="CargoState" order="901">
<comments>untested. How things move from Bill to Bill</comments>
<fields>
 <field name="cargo" data_type="integer" size="" is_nullable="0" order="1" />
 <field name="toCargo" data_type="integer" size="" is_nullable="0" order="2" />
 <field name="count" data_type="float" is_nullable="1" order="3">
  <comments>NULL is count 1</comments>
 </field>
 <field name="journal" data_type="integer" size="" is_nullable="1" order="4" />
 <field name="entry" data_type="integer" size="" is_nullable="1" order="5" />
</fields>
<indices>
</indices>
<constraints>
 <constraint name="cargostate_entry" type="FOREIGN KEY" fields="entry" reference_table="Entry" reference_fields="id" deferrable="1" />
 <comments invalid=""><constraint name="invalid0" type="FOREIGN KEY" fields="cargo" reference_table="Cargo" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid1" type="FOREIGN KEY" fields="toCargo" reference_table="Cargo" reference_fields="id" deferrable="1" /></comments>
 <comments invalid=""><constraint name="invalid2" type="FOREIGN KEY" fields="journal,entry" reference_table="JournalEntry" reference_fields="journal,entry" deferrable="1" /></comments>
</constraints>
</table>


<comments>Template</comments>
<table name="unfinished" order="910">
<comments>untested</comments>
<fields>
 <field name="id" data_type="integer" size="" is_nullable="0" is_auto_increment="1" is_primary_key="0" is_foreign_key="0" order="1" />
 <field name="field" data_type="integer" size="" is_nullable="1" order="3" />
 <field name="created" data_type="timestamp" size="0" is_nullable="0" default_value="NOW()" order="99" />
</fields>
<indices>
</indices>
<constraints>
</constraints>
</table>
</tables>


<views>
 <comments>SQLFairy does not handle XML escape codes.  So need to convert post process.</comments>
 <view name="People" fields="individual,name,goesBy,birthday,in_days,fullName,honorific,given,middle,family,suffix,post,honorificvalue,givenvalue,middlevalue,familyvalue,suffixvalue,postvalue,birth,death,aged,created" order="1">
 <sql>
SELECT Individual.id AS individual, Name.id AS name,
 COALESCE(goesBy.value,Given.value,Family.value) AS goesBy,
 birthday(CAST(birth AS date),CAST(NOW() AS date)) AS birthday,
 days_until_birthday(CAST(birth AS date), CAST(NOW() AS date)) AS in_days,
 COALESCE(honorific.value,!apos;!apos;) ||
  CASE WHEN (honorific.value IS NOT NULL AND Given.value IS NULL AND middle.value IS NULL) THEN !apos; !apos; ELSE !apos;!apos; END ||
  COALESCE(CASE WHEN (honorific.value IS NOT NULL) THEN !apos; !apos; ELSE !apos;!apos; END || Given.value,!apos;!apos;) ||
  COALESCE(CASE WHEN (Given.value IS NOT NULL) THEN !apos; !apos; ELSE !apos;!apos; END || middle.value,!apos;!apos;) ||
  CASE WHEN (Given.value IS NOT NULL AND middle.value IS NULL) THEN !apos; !apos; ELSE !apos;!apos; END ||
  COALESCE(CASE WHEN (middle.value IS NOT NULL) THEN !apos; !apos; ELSE !apos;!apos; END  || Family.value,!apos;!apos;) ||
  COALESCE(CASE WHEN (Family.value IS NOT NULL) THEN !apos; !apos; ELSE !apos;!apos; END || suffix.value,!apos;!apos;) ||
  COALESCE(CASE WHEN (suffix.value IS NOT NULL) THEN !apos; !apos; ELSE !apos;!apos; END || post.value,!apos;!apos;)
  AS fullName,
 Individual.prefix AS honorific,
 Name.given, Name.middle, Name.family,
 Individual.suffix,
 Individual.post,
 honorific.value AS honorificValue,
 Given.value AS GivenValue, middle.value AS middleValue, Family.value AS FamilyValue,
 suffix.value AS suffixValue,
 post.value AS postValue,
 birth, death,
 COALESCE(age(death,birth),age(birth)) AS aged,
 Individual.created
FROM Individual
JOIN Name ON Name.id = Individual.name
LEFT JOIN Given ON Given.id = Name.given
LEFT JOIN Given AS middle ON middle.id = Name.middle
LEFT JOIN Given AS goesBy ON goesBy.id = Individual.goesBy
LEFT JOIN Family ON Family.id = Name.family
LEFT JOIN Word AS honorific ON honorific.id = Individual.prefix
 AND honorific.culture = ClientCulture()
LEFT JOIN Word AS suffix ON suffix.id = Individual.suffix
 AND suffix.culture = ClientCulture()
LEFT JOIN Word AS post ON post.id = Individual.post
 AND post.culture = ClientCulture()
WHERE Individual.nameChange IS NULL
 OR Individual.nameChange > NOW()
 </sql>
 </view>

 <view name="IndividualPersonEvent" fields="individual,name,honorific,suffix,post,goesby,birth,death,event" order="2">
 <comments>
  Convert individual table transactions into individual person life events.
  Primarily as an input to the PeopleEvent view.
 </comments>
 <sql>
SELECT DISTINCT Individual.id AS individual,
 Individual.name,
 COALESCE(future.prefix, Individual.prefix) AS honorific,
 COALESCE(future.suffix, Individual.suffix) AS suffix,
 COALESCE(future.post, Individual.post) AS post,
 COALESCE(future.goesBy, Individual.goesBy) AS goesBy,
 Individual.birth,
 Individual.death,
 CASE WHEN previous.id IS NULL THEN
  -- Check for single event
  CASE WHEN future.id IS NULL THEN
   COALESCE(Individual.death,Individual.nameChange,Individual.birth)
  ELSE
   -- Check for individual attribute change only
   CASE WHEN (future.goesBy != Individual.goesBy)
     OR (future.goesBY IS NOT NULL AND Individual.goesBy IS NULL)
     OR (future.goesBY IS NULL AND Individual.goesBy IS NOT NULL)
     OR (future.prefix != Individual.prefix)
     OR (future.prefix IS NOT NULL AND Individual.prefix IS NULL)
     OR (future.prefix IS NULL AND Individual.prefix IS NOT NULL)
     OR (future.suffix != Individual.suffix)
     OR (future.suffix IS NOT NULL AND Individual.suffix IS NULL)
     OR (future.suffix IS NULL AND Individual.suffix IS NOT NULL)
     OR (future.post != Individual.post)
     OR (future.post IS NOT NULL AND Individual.post IS NULL)
     OR (future.post IS NULL AND Individual.post IS NOT NULL)
   THEN
    -- individual attriute change only
    Individual.nameChange
   ELSE
    Individual.birth
   END
  END
 ELSE
  CASE WHEN future.id IS NULL THEN
   COALESCE(Individual.death,previous.nameChange,Individual.nameChange,Individual.birth)
  ELSE
   Individual.nameChange
  END
 END AS event
FROM Individual
CROSS JOIN Name
LEFT JOIN Individual AS previous ON previous.id = Individual.id
 AND (
  (COALESCE(previous.nameChange,previous.death) !lt; COALESCE(Individual.nameChange,Individual.death))
  OR
  (Individual.death IS NULL AND Individual.nameChange IS NULL
   AND previous.nameChange IS NOT NULL)
 )
LEFT JOIN Individual AS future ON future.id = Individual.id
 AND COALESCE(future.nameChange,future.birth) !gt;= COALESCE(Individual.nameChange,Individual.death)
 AND future.death IS NULL
WHERE Name.id = Individual.name
 </sql>
 </view>

 <view name="PeopleEvent" fields="individual,name,goesby,fullname,date,event,eventname,honorific,given,middle,family,suffix,post,honorificvalue,givenvalue,middlevalue,familyvalue,suffixvalue,postvalue" order="3">
 <sql>
SELECT IndividualPersonEvent.individual, IndividualPersonEvent.name,
 COALESCE(goesBy.value,Given.value,Family.value) AS goesBy,
 COALESCE(honorific.value || !apos; !apos;,!apos;!apos;) ||
  COALESCE(Given.value || !apos; !apos;,!apos;!apos;) ||
  COALESCE(middle.value || !apos; !apos;,!apos;!apos;) ||
  COALESCE(Family.value || !apos; !apos;,!apos;!apos;) ||
  COALESCE(suffix.value || !apos; !apos;,!apos;!apos;) ||
  COALESCE(post.value || !apos; !apos;,!apos;!apos;)
  AS fullName,
 event AS date,
 COALESCE(born.id, death.id, change.id) AS event,
 COALESCE(born.value, death.value, change.value) AS eventName,
 IndividualPersonEvent.honorific,
 Name.given,
 Name.middle,
 Name.family,
 IndividualPersonEvent.suffix,
 IndividualPersonEvent.post,
 honorific.value AS honorificValue,
 Given.value AS GivenValue,
 middle.value AS middleValue,
 Family.value AS FamilyValue,
 suffix.value AS suffixValue,
 post.value AS postValue
FROM IndividualPersonEvent
 JOIN Name ON Name.id = IndividualPersonEvent.name
 LEFT JOIN Given On Given.id = Name.given
 LEFT JOIN Given AS middle ON middle.id = Name.middle
 LEFT JOIN Given AS goesBy ON goesBy.id = IndividualPersonEvent.goesBy
 LEFT JOIN Family ON Family.id = Name.family
 LEFT JOIN Word AS honorific ON honorific.id = IndividualPersonEvent.honorific
  AND honorific.culture = ClientCulture()
 LEFT JOIN Word AS suffix ON suffix.id = IndividualPersonEvent.suffix
  AND suffix.culture = ClientCulture()
 LEFT JOIN Word AS post ON post.id = IndividualPersonEvent.post
  AND post.culture = ClientCulture()
 LEFT JOIN Word AS born ON born.value = !apos;Born!apos; AND born.culture = ClientCulture() AND birth = event
 LEFT JOIN Word AS death ON death.value = !apos;Died!apos; AND death.culture  = ClientCulture() AND death = event
 LEFT JOIN Word AS change ON change.value = !apos;Changed name!apos; AND change.culture  = ClientCulture()
 </sql>
 </view>

 <view name="Entities" fields="individual,entity,goesBy,name,formed,location,dissolved,aged,created" order="20">
  <sql>
SELECT Individual.id AS individual, Individual.entity, goesBy.value AS goesBy,
 Entity.name, Individual.birth AS formed,
 Individual.location,
 Individual.death AS dissolved,
 COALESCE(age(death,birth),age(birth)) AS aged,
 Individual.created
FROM Individual
JOIN Entity ON Entity.id = Individual.entity
LEFT JOIN Given AS goesBy ON goesBy.id = Individual.goesBy
WHERE Individual.nameChange IS NULL
  </sql>
 </view>
 <view name="List" fields="id,individual,name,namevalue,listSet,listSetValue,sequence" order="30">
  <sql>
SELECT ListIndividual.id,
 ListIndividual.individual,
 ListIndividualName.name AS listName,
 Name.value AS listNameValue,
 ListIndividualName.listSet,
 ListSet.value AS listSetValue,
 ListIndividualName.sequence,
 CASE WHEN SendField.value IS NULL THEN !apos;to!apos; ELSE SendField.value END AS send,
 ListIndividual.created
FROM ListIndividual
JOIN ListIndividualName ON ListIndividualName.ListIndividual = ListIndividual.id
 AND ListIndividualName.optinStyle = 1
JOIN Word AS Name ON ListIndividualName.name = Name.id
 AND Name.culture = ClientCulture()
LEFT JOIN Word AS ListSet ON ListIndividualName.listSet = ListSet.id
 AND ListSet.culture = ClientCulture()
LEFT JOIN Word AS SendField ON SendField.id = ListIndividual.type
 AND SendField.culture IS NULL
LEFT JOIN ListIndividual AS disable ON disable.individual = ListIndividual.individual
 AND disable.id IS NULL
 AND disable.unlist IS NULL
WHERE disable.individual IS NULL
 AND ListIndividual.unlist IS NULL
  </sql>
 </view>
 <view name="EmailAddress" fields="email,username,plus,host,value">
 <sql>
SELECT id AS email, username, plus, host,
 username ||
 COALESCE(!apos;+!apos; || plus, !apos;!apos;) ||
 !apos;@!apos; || host AS value
FROM Email
 </sql>
 </view>
 <view name="URL" fields="path,protocol,host,value,created">
  <sql>
SELECT id AS path, protocol, host,
 protocol ||
 CASE WHEN secure = 1 THEN !apos;s!apos; ELSE !apos;!apos; END ||
 !apos;://!apos; || host || !apos;/!apos; ||
 COALESCE(value,!apos;!apos;) ||
 CASE WHEN get IS NULL
 THEN !apos;!apos;
 ELSE !apos;?!apos; || get
 END AS value,
 created
FROM Path
  </sql>
 </view>
 <view name="File" fields="path,protocol,host,value,file,created">
  <sql>
SELECT id AS path, protocol, host,
 protocol ||
 !apos;:///!apos; ||
 COALESCE(value,!apos;!apos;) ||
 CASE WHEN value IS NOT NULL
 THEN !apos;/!apos;
 ELSE !apos;!apos;
 END ||
 COALESCE(get,!apos;!apos;)
 AS value,
 !apos;/!apos; ||
 COALESCE(value,!apos;!apos;) ||
 CASE WHEN value IS NOT NULL
 THEN !apos;/!apos;
 ELSE !apos;!apos;
 END ||
 COALESCE(get,!apos;!apos;)
 AS file,
 created
FROM Path
  </sql>
 </view>
 <view name="IndividualURL" fields="individual,type,path,protocol,host,value,created">
  <sql>
WITH latest (individual,type,created) AS (
 SELECT individual, type, MAX(created) AS created
 FROM IndividualPath
 WHERE IndividualPath.stop IS NULL
 GROUP BY individual, type
)
SELECT latest.individual, latest.type, Path.id AS path, Path.protocol, Path.host,
 Path.protocol ||
 CASE WHEN secure = 1 THEN !apos;s!apos; ELSE !apos;!apos; END ||
 !apos;://!apos; || host || !apos;/!apos; ||
 COALESCE(Path.value,!apos;!apos;) ||
 CASE WHEN COALESCE(Path.get,IndividualPath.track) IS NULL
 THEN !apos;!apos;
 ELSE !apos;?!apos; ||
 COALESCE(Path.get,!apos;!apos;) ||
 COALESCE(CASE WHEN (Path.get IS NOT NULL AND IndividualPath.track IS NOT  NULL) THEN !apos;!amp;!apos; ELSE !apos;!apos; END ||  IndividualPath.track, !apos;!apos;)
 END AS value,
 latest.created
FROM latest
JOIN IndividualPath ON IndividualPath.individual = latest.individual
 AND IndividualPath.type = latest.type
 AND IndividualPath.created = latest.created
JOIN Individual ON Individual.id = latest.individual
 AND Individual.nameChange IS NULL
JOIN Path ON Path.id = IndividualPath.path
  </sql>
 </view>
 <view name="IndividualEmailAddress" fields="individual,type,email,username,plus,host,value,created">
  <sql>
WITH latest (individual,type,created) AS (
 SELECT individual, type, MAX(created) AS created
 FROM IndividualEmail
 WHERE IndividualEmail.stop IS NULL
 GROUP BY individual, type
)
SELECT latest.individual, latest.type, IndividualEmail.email, EmailAddress.username,
 EmailAddress.plus, EmailAddress.host, EmailAddress.value, latest.created
FROM latest
JOIN Individual ON Individual.id = latest.individual
 AND Individual.nameChange IS NULL
JOIN IndividualEmail ON IndividualEmail.individual = latest.individual
 AND IndividualEmail.type = latest.type
 AND IndividualEmail.created = latest.created
JOIN EmailAddress ON EmailAddress.email = IndividualEmail.email
  </sql>
 </view>
 <view name = "Phones" fields="phone,country,location,area,number,idd,ndd,code,local,international" >
  <sql>
SELECT Phone.id AS phone, Phone.country, Phone.location,
 Phone.area, Phone.number, Country.idd, Country.ndd,
 Country.code,
 Phone.area || !apos;-!apos; || LEFT(number,3) || !apos;-!apos; || RIGHT(number,4) AS local,
 Country.idd || !apos;-!apos; || Country.ndd || !apos;-!apos; ||   Phone.area || !apos;-!apos; || LEFT(number,3) || !apos;-!apos; || RIGHT(number,4)AS international
FROM Phone
JOIN Country ON Country.id = Phone.country
  </sql>
 </view>
 <view name="Addresses" fields="address,line1,line2,line3,city,state,zipcode,postalcode,country,countrycode,marquee,location,latitude,longitude">
  <sql>
SELECT Address.id AS address,
 line1, line2, line3,
 City.value AS city,
 COALESCE(UPPER(StateAbbr.value), State.value) AS state,
 Postal.code ||
 CASE WHEN (postalplus IS NOT NULL) THEN !apos;-!apos; ELSE !apos;!apos; END ||
 Address.postalplus AS zipcode,
 Postal.code AS postalcode,
 Country.id AS country,
 Country.code AS countrycode,
 COALESCE(AddressLocation.marquee, PostalLocation.marquee, CountryLocation.marquee) AS marquee,
 COALESCE(AddressLocation.id, PostalLocation.id, CountryLocation.id) AS location,
 COALESCE(AddressLocation.latitude, PostalLocation.latitude, CountryLocation.latitude) AS latitude,
 COALESCE(AddressLocation.longitude, PostalLocation.longitude, CountryLocation.longitude) AS longitude
FROM Address
JOIN Postal ON Postal.id = Address.postal
JOIN Country ON Country.id = Postal.country
JOIN Word AS City ON City.id = Postal.city
 AND City.culture = ClientCulture()
JOIN Word AS State ON State.id = Postal.state
 AND State.culture =  ClientCulture()
LEFT JOIN Word AS StateAbbr ON StateAbbr.id = Postal.stateAbbreviation
 AND StateAbbr. culture =  ClientCulture()
LEFT JOIN Location AS AddressLocation On AddressLocation.id = Address.location
LEFT JOIN Location AS PostalLocation ON PostalLocation.id = Postal.location
LEFT JOIN Location AS CountryLocation ON CountryLocation.id = Country.location
  </sql>
 </view>
 <view name="Versions" fields="version,name,value,major,minor,patch">
  <sql>
SELECT Version.id AS version, COALESCE(nameLocal.value,name.value) AS name,
 COALESCE(majorLocal.value,major.value) ||
  COALESCE(!apos;.!apos; || COALESCE(minorLocal.value,minor.value), !apos;!apos;) ||
  COALESCE(!apos;.!apos; || COALESCE(patchLocal.value,patch.value), !apos;!apos;)
 AS value,
 COALESCE(majorLocal.value,major.value) AS major,
 COALESCE(minorLocal.value,minor.value) AS minor,
 COALESCE(patchLocal.value,patch.value) AS patch
FROM Version
LEFT JOIN Word AS nameLocal ON nameLocal.id = Version.name
 AND nameLocal.culture = ClientCulture()
LEFT JOIN Word AS name ON name.id = Version.name
 AND name.culture = 1033
LEFT JOIN Word AS majorLocal ON majorLocal.id = Version.major
 AND majorLocal.culture = ClientCulture()
LEFT JOIN Word AS major ON major.id = Version.major
 AND major.culture = 1033
LEFT JOIN Word AS minorLocal ON minorLocal.id = Version.minor
 AND minorLocal.culture = ClientCulture()
LEFT JOIN Word AS minor ON minor.id = Version.minor
 AND minor.culture = 1033
LEFT JOIN Word AS patchLocal ON patchLocal.id = Version.patch
 AND patchLocal.culture = ClientCulture()
LEFT JOIN Word AS patch ON patch.id = Version.patch
 AND patch.culture = 1033
  </sql>
 </view>
 <view name="ParsedAgentStringShort" fields="agentstring,deviceid,device,osid,os,agentid,agent,deviceversion,osapplicationrelease,agentapplicationrelease">
  <sql>
SELECT AgentString.id AS agentString,
 device.id AS deviceid, deviceName.value AS device,
 OS.id AS osid, OSName.value AS OS,
 Agent.id AS agentid, AgentName.value AS agent,
 device.version AS deviceversion,
 deviceOS.applicationrelease AS osApplicationRelease,
 agentApplicationRelease.id AS agentApplicationRelease
FROM AgentString
JOIN AssemblyApplicationRelease AS deviceAgent ON deviceAgent.id = agentString.agent
JOIN Part AS device ON device.id = deviceAgent.assembly
JOIN Sentence AS deviceName ON deviceName.id = device.name AND deviceName.culture = ClientCulture()
JOIN AssemblyApplicationRelease AS deviceOS ON deviceOS.id = deviceAgent.parent
JOIN ApplicationRelease AS OSapplicationRelease ON OSapplicationRelease.id = deviceOS.applicationRelease
JOIN Application AS OS ON OS.id = OSapplicationRelease.application
JOIN Word AS OSName ON OSName.id = OS.name AND OSName.culture = ClientCulture()
JOIN ApplicationRelease AS agentApplicationRelease ON agentApplicationRelease.id = deviceAgent.applicationRelease
JOIN Application AS Agent On Agent.id = agentApplicationRelease.application
JOIN Word AS AgentName ON AgentName.id = Agent.name AND AgentName.culture = ClientCulture()
  </sql>
 </view>
 <view name="ParsedAgentString" fields="agentstring,deviceid,deviceversion,device,deviceersionname,osid,osversion,os,osversionname,agentid,agentversion,agent,agentversionname">
  <sql>
SELECT agentstring,
 deviceid, deviceversion, device, deviceversionname.value as deviceersionname,
 osid, OSRelease.version AS osversion, os, OSVersion.value AS osversionname,
 agentid, AgentVersion.version AS agentversion, agent, AgentVersion.value agentversionname
FROM ParsedAgentStringShort
JOIN ApplicationRelease AS OSApplicatonRelease ON OSApplicatonRelease.id = osapplicationrelease
JOIN ApplicationRelease AS AgentApplicationRelease ON AgentApplicationRelease.id = agentApplicationRelease
LEFT JOIN Versions AS deviceversionname ON deviceversionname.version = deviceversion
LEFT JOIN Release AS OSRelease ON OSRelease.id = OSApplicatonRelease.release
LEFT JOIN Versions AS OSVersion ON OSVersion.version = OSRelease.version
LEFT JOIN Release AS AgentRelease ON AgentRelease.id = AgentApplicationRelease.release
LEFT JOIN Versions AS AgentVersion ON AgentVersion.version = AgentRelease.version
  </sql>
 </view>
 <view name="Sessions" fields="session,token,siteapplicationrelease,agentstring,deviceid,device,osid,os,agentid,agent,referring,referrringurl,fromaddress,credential,individual,username,email,created,touched">
  <sql>
SELECT session.id AS session,
 sessionToken.token, sessionToken.siteapplicationrelease,
 sessionCredential.agentstring,
 deviceid, ParsedAgentStringShort.device, osid, ParsedAgentStringShort.os, agentid, ParsedAgentStringShort.agent,
 sessionCredential.referring, URL.value AS referrringURL,
 sessionCredential.fromaddress,
 sessionCredential.credential, credential.individual,  credential.username,
 EmailAddress.value AS email,
 COALESCE(sessionToken.created, session.created) AS created, session.touched
FROM session
CROSS JOIN sessionCredential
LEFT JOIN sessionToken ON sessionToken.session = session.id
LEFT JOIN ParsedAgentStringShort ON ParsedAgentStringShort.agentstring = sessionCredential.agentstring
LEFT JOIN credential ON credential.id = sessionCredential.credential
LEFT JOIN EmailAddress ON EmailAddress.email = credential.email
LEFT JOIN URL ON URL.path = sessionCredential.referring
WHERE session.id = sessionCredential.session
  </sql>
 </view>
 <view name="Parts" fields="part,parent,name,nameId,version,versionId,serial,created">
  <sql>
SELECT Part.id AS part, Part.parent,
 Sentence.value AS name, Part.name AS nameId,
 CASE WHEN (Versions.name IS NOT NULL) THEN Versions.name ELSE !apos;!apos; END ||
 CASE WHEN (Versions.name IS NOT NULL) THEN !apos; !apos; ELSE !apos;!apos; END ||
 CASE WHEN (Versions.value IS NOT NULL) THEN Versions.value ELSE !apos;!apos; END AS version,
 Part.version AS versionId,
 Part.serial, Part.created
FROM Part
JOIN Sentence ON Sentence.id = Part.name
 AND Sentence.culture = ClientCulture()
LEFT JOIN Versions ON Versions.version = Part.version
  </sql>
 </view>
 <view name="Assemblies" fields="assembly, parentName, name, version, versionName, serial">
  <sql>
SELECT DISTINCT AssemblyPart.assembly, parent.name AS parentName,
 assemblies.name,
 assemblies.versionId AS version, assemblies.version as versionName, assemblies.serial
FROM AssemblyPart
JOIN Parts AS assemblies ON assemblies.part = AssemblyPart.assembly
JOIN Parts AS parent ON parent.part = assemblies.parent
  </sql>
 </view>
 <view name="AssemblyParts" fields="assembly, parentName, assemblyName, assemblyVersion, assemblyVersionName, assemblySerial, quantity, designator, part, partName, version, versionName, serial">
  <sql>
SELECT AssemblyPart.assembly, parent.name AS parentName,
 assemblies.name AS assemblyName,
 assemblies.versionid AS assemblyVersion, assemblies.version AS assemblyVersionName,
 assemblies.serial AS assemblySerial,
 AssemblyPart.quantity,
 designator.value AS designator,
 parts.part, parts.name AS partName,
 parts.versionid AS version, parts.version AS versionName,
 parts.serial
FROM AssemblyPart
JOIN Parts AS assemblies ON assemblies.part = AssemblyPart.assembly
JOIN Parts AS parent ON parent.part = assemblies.parent
JOIN Parts AS parts ON parts.part = AssemblyPart.part
LEFT JOIN Word AS designator ON designator.id = AssemblyPart.designator
 AND designator.culture = ClientCulture()
  </sql>
 </view>

 <view name="Periods" fields="period,name,periodname">
   <sql>
SELECT PeriodName.period, PeriodName.name, Sentence.value AS periodName
FROM PeriodName
LEFT JOIN Sentence ON Sentence.id = PeriodName.name
 AND Sentence.culture = ClientCulture()
   </sql>
 </view>

 <view name="PeriodSpans" fields="period,name,periodname,span,exclude,monthdaymonth,day,weekofmonth,dayofweekstart,dayofweekstop,dayofmonth,month,monthyear,daterangestart,daterangestop,timeofdaystart,timeofdaystop">
   <sql>
SELECT PeriodName.period, PeriodName.name, Sentence.value AS periodName,
 Period.span, Period.exclude,
 MonthDay.month AS MonthDaymonth, MonthDay.day, MonthDay.weekOfMonth,
 DayOfWeek.start AS dayOfWeekStart, DayOfWeek.stop AS dayOfWeekStop, DayOfWeek.dayOfMonth,
 Month.month, Month.year AS monthYear,
 DateRange.start AS dateRangeStart, DateRange.stop AS dateRangeStop,
 TimeOfDay.start AS timeOfDayStart, TimeOfDay.stop AS timeOfDayStop
FROM Period
JOIN PeriodName ON PeriodName.period = Period.id
JOIN Sentence ON Sentence.id = PeriodName.name
 AND Sentence.culture = ClientCulture()
LEFT JOIN MonthDay  ON MonthDay.id  = Period.span
LEFT JOIN DayOfWeek ON DayOfWeek.id = Period.span
LEFT JOIN Month     ON Month.id     = Period.span
LEFT JOIN DateRange ON DateRange.id = Period.span
LEFT JOIN TimeOfDay ON TimeOfDay.id = Period.span
   </sql>
 </view>

 <view name="TimePeriod" fields="period, open">
  <sql>
SELECT period, bool_AND(open) AS open
FROM (
SELECT Period.id AS period,
 CAST(ClientNow() AS date) &gt; make_date(CAST(extract(year FROM ClientNow()) AS integer),MonthDay.month, MonthDay.day) -1 AND
 CAST(ClientNow() AS date) &lt;= make_date(CAST(extract(year FROM ClientNow()) AS integer),MonthDay.month, MonthDay.day) AS open
FROM Period
JOIN MonthDay ON MonthDay.id = Period.span
 AND MonthDay.weekOfMonth IS NULL
UNION
SELECT Period.id AS period,
 Month.month = extract(month FROM ClientNow())
FROM Period
JOIN Month ON Month.id = Period.span
 AND Month.year IS NULL
UNION
SELECT Period.id AS period,
 CAST(ClientNow() AS date) = (
  make_date(CAST(extract(year FROM ClientNow()) AS integer),CAST(extract(month FROM ClientNow()) AS integer), 1) + 7 * (DayOfWeek.start - 1) +
  CAST((7 + DayOfWeek.dayOfMonth - (dayofweek(
    make_date(CAST(extract(year FROM ClientNow()) AS integer),CAST(extract(month FROM ClientNow()) AS integer), 1) + 7 * (DayOfWeek.start - 1)
   ) -1)
  ) AS integer) %7
 )
FROM Period
JOIN DayOfWeek ON DayOfWeek.id = Period.span
 AND DayOfWeek.stop IS NULL
 AND DayOfWeek.dayOfMonth &gt; 0
UNION
SELECT Period.id AS period,
 CAST(ClientNow() AS time) &gt;= start
  AND CAST(ClientNow() AS time) &lt; stop
FROM Period
JOIN TimeOfDay ON TimeOfDay.id = Period.span
 AND TimeOfDay.start &lt; TimeOfDay.stop
UNION
SELECT Period.id AS period,
 (CAST(ClientNow() AS time) &gt;= start
   AND CAST(ClientNow() AS time) &lt;= !apos;23:59:59!apos;
 ) OR (
  CAST(ClientNow() AS time) &lt; stop
   AND CAST(ClientNow() AS time) &gt;= !apos;00:00:00!apos;
 )
FROM Period
JOIN TimeOfDay ON TimeOfDay.id = Period.span
 AND TimeOfDay.start &gt; TimeOfDay.stop
) AS timeperiod
GROUP BY period
  </sql>
 </view>

 <view name="MaxSpan" fields="id">
  <comments>These tables share a unique sequence for their respective id fields.  A unique id value must not exist in more than a single Span table.</comments>
  <sql>
SELECT MAX(id) AS id FROM (
 SELECT coalesce(MAX(id), 0) AS id FROM DateRange
 UNION
 SELECT COALESCE(MAX(id), 0) AS id FROM TimeOfDay
 UNION
 SELECT COALESCE(MAX(id), 0) AS id FROM DayOfWeek
 UNION
 SELECT COALESCE(MAX(id), 0) AS id FROM MonthDay
 UNION
 SELECT COALESCE(MAX(id), 0) AS id FROM Month
) AS MaxSpan
  </sql>
 </view>

 <view name="Accounts" fields="account,name,type,credit,debitIncrease,debitDecrease,creditIncrease,creditDecrease">
  <sql>
SELECT AccountName.account,
 Sentence.value AS name,
 Word.value AS type,
 AccountName.credit,
 CASE WHEN NOT AccountName.credit THEN
  1
 ELSE
  NULL
 END AS debitIncrease,
 CASE WHEN AccountName.credit THEN
  1
 ELSE
  NULL
 END AS debitDecrease,
 CASE WHEN AccountName.credit THEN
  1
 ELSE
  NULL
 END AS creditIncrease,
 CASE WHEN NOT AccountName.credit THEN
  1
 ELSE
  NULL
 END AS creditDecrease
FROM AccountName
JOIN Sentence ON Sentence.id = AccountName.name
 AND Sentence.culture = ClientCulture()
JOIN Word ON Word.id = AccountName.type
 AND Word.culture = ClientCulture()
  </sql>
 </view>

 <view name="Ledgers" fields="ledger,name">
  <sql>
SELECT LedgerName.ledger,
 Sentence.value AS name,
 Accounts.account,
 Accounts.name AS accountName,
 Accounts.type AS type,
 Accounts.credit,
 Accounts.debitIncrease,
 Accounts.debitDecrease,
 Accounts.creditIncrease,
 Accounts.creditDecrease
FROM LedgerName
JOIN Sentence ON Sentence.id = LedgerName.name
 AND Sentence.culture = ClientCulture()
JOIN LedgerAccount ON LedgerAccount.ledger = LedgerName.ledger
JOIN Accounts ON Accounts.account = LedgerAccount.account
  </sql>
 </view>

 <view name="Journals" fields=""><comments>TODO Join JournalAccount AND Accounts</comments>
  <sql>
SELECT JournalName.journal,
 Sentence.value AS name
FROM JournalName
JOIN Sentence ON Sentence.id = JournalName.name
 AND Sentence.culture = ClientCulture()
  </sql>
 </view>

 <view name="Books" fields=""><comments>TODO Support Multiple BookAccount account records</comments>
  <sql>
SELECT BookName.book,
 Sentence.value AS name,
 BookName.journal,
 Journals.name AS journalName,
 BookAccount.increase,
 Increase.name AS increaseName,
 Increase.type AS increaseType,
 Increase.credit AS increaseCredit,
 Increase.debitIncrease  AS increaseDebitIncrease,
 Increase.debitDecrease  AS increaseDebitDecrease,
 Increase.creditIncrease AS increaseCreditIncrease,
 Increase.creditDecrease  AS increaseCreditDecrease,
 BookAccount.decrease,
 Decrease.name AS decreaseName,
 Decrease.type AS decreaseType,
 Decrease.credit AS decreaseCredit,
 Decrease.debitIncrease  AS decreaseDebitIncrease,
 Decrease.debitDecrease  AS decreaseDebitDecrease,
 Decrease.creditIncrease AS decreaseCreditIncrease,
 Decrease.creditDecrease AS decreaseCreditDecrease
FROM BookName
JOIN Sentence ON Sentence.id = BookName.name
 AND Sentence.culture = ClientCulture()
JOIN Journals ON Journals.journal = BookName.journal
JOIN BookAccount ON BookAccount.book = BookName.book
LEFT JOIN Accounts AS Increase ON Increase.account = BookAccount.increase
LEFT JOIN Accounts AS Decrease  ON Decrease.account  = BookAccount.decrease
  </sql>
 </view>


 <view name="JournalEntries" fields="">
  <comments>ORDER BY created, entry, rightSide</comments>
  <sql>
SELECT JournalEntry.id,
 JournalEntry.journal,
 JournalNameString.value AS journalName,
 JournalEntry.book,
 BookNameString.value AS bookName,
 JournalEntry.entry,
 JournalEntry.account,
 AccountNameString.value AS accountName,
 AccountTypeName.value AS type,
 LedgerJournal.ledger,
 LedgerNameString.value AS ledgerName,
 JournalEntry.credit AS rightSide,
 CASE WHEN NOT JournalEntry.credit THEN
  JournalEntry.amount
 END AS debit,
 CASE WHEN JournalEntry.credit THEN
  JournalEntry.amount
 END AS credit,
 JournalEntry.posted,
 JournalEntry.created
FROM JournalEntry
JOIN AccountName ON AccountName.account = JournalEntry.account
JOIN Sentence AS AccountNameString ON AccountNameString.id = AccountName.name
 AND AccountNameString.culture = ClientCulture()
JOIN Word AS AccountTypeName ON AccountTypeName.id = AccountName.type
 AND AccountTypeName.culture = ClientCulture()
JOIN JournalName ON JournalName.journal = JournalEntry.journal
JOIN Sentence AS JournalNameString ON JournalNameString.id = JournalName.name
 AND JournalNameString.culture = ClientCulture()
LEFT JOIN BookName ON BookName.book = JournalEntry.book
LEFT JOIN Sentence AS BookNameString ON BookNameString.id = BookName.name
 AND BookNameString.culture = ClientCulture()
LEFT JOIN LedgerJournal ON LedgerJournal.journal = JournalEntry.journal
LEFT JOIN LedgerName ON LedgerName.ledger = LedgerJournal.ledger
LEFT JOIN Sentence AS LedgerNameString ON LedgerNameString.id =LedgerName.name
 AND LedgerNameString.culture = ClientCulture()
  </sql>
 </view>
</views>
<triggers></triggers>
<procedures></procedures>
</schema>
